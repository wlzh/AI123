

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>基于ChatGPT&#43;StableDiffusion实现AI绘画 作者： 腾讯云开发者 来源： 腾讯云开发者 👉导读 近年来，AI 生成内容（AIGC）领域的飞速发展催生了诸多创新技术与应用，尤其是 AI 绘画。为降低构建 Prompt 的复杂性，本文基于 ChatGPT 实现了一个 Stable Diffusion 提示词生成器，支持多语言提示词和智能优化与扩展提示词，助力初学者轻  | AI123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AI123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://ai123.869hr.uk/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://ai123.869hr.uk/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AI123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">基于ChatGPT&#43;StableDiffusion实现AI绘画</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://ai123.869hr.uk/about>AI123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              July 27, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tFjIMWwC10KSQByWCicvh2PSGrhcJwyicdaX8p7VvKUVSXnF4prprC4Zw/640?wx_fmt=jpeg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： 腾讯云开发者  来源： <a href="https://mp.weixin.qq.com/s/MvxS3PUG8pYobxDCAZtdcg">腾讯云开发者</a></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe94cQiccAo2zibZETiaOnMVLNQAO0Zne2x8KlehRMR8AsOTW90m1pAicBEw5wBJFkQiax8ricKGbKibEKV8gQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_gif/VY8SELNGe96srmm5CxquJGSP4BbZA8IDLUj8l7F3tzrm8VuILsgUPDciaDLtvQx78DbkrhAqOJicxze5ZUO5ZLNg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>👉导读</p>
<p>近年来，AI 生成内容（AIGC）领域的飞速发展催生了诸多创新技术与应用，尤其是 AI 绘画。为降低构建 Prompt 的复杂性，本文基于 ChatGPT 实现了一个 Stable Diffusion 提示词生成器，支持多语言提示词和智能优化与扩展提示词，助力初学者轻松探索 AI 绘画世界~</p>
<p>👉目录</p>
<p>1 背景</p>
<p>2 实现原理</p>
<p>2.1 Stable Diffusion</p>
<p>2.2 Prompt Generator</p>
<p>3 效果展示</p>
<p>3.1 中国古代，赛博朋克，机械仙鹤</p>
<p>3.2 梵高风格，塞尔达旷野之息</p>
<p>3.3 春眠不觉晓，处处闻啼鸟</p>
<p>3.4 天空之城</p>
<p>4 总结与展望</p>
<h4 id="01">01</h4>
<p>背景</p>
<p>近年来，AI 生成内容（AIGC）领域发展迅猛，涌现出众多创新技术和应用。其中，AI 绘画作为一个重要的分支，自2022年起取得了显著的进展，吸引了广泛关注。从2022年2月初备受瞩目的 Disco Diffusion，到4月份 OpenAI 发布的强大文本到图像生成模型DALL·E 2，紧接着5月份 Google 推出了 Imagen 模型。同年8月份，初创公司 StabilityAI 发布并开源了卓越的 AI 绘画模型 Stable Diffusion。而最近，令人惊叹且广受好评的 Midjourney 也成为了热门话题。这些技术和应用的快速发展充分展现了 AI 绘画领域的巨大潜力。</p>
<p>目前，AI 绘画模型中最受欢迎的无疑是 Stable Diffusion 和 Midjourney。在 AI 绘画领域，Prompt（提示词）起着至关重要的作用。通常情况下， Prompt 质量越高，生成的图片效果越令人满意。然而，无论是 Stable Diffusion 还是 Midjourney，都面临着构建 Prompt 的复杂性较高，对于初学者来说具有一定的门槛。此外，这些模型都是基于英文语料数据集进行训练的，因此并不支持原生中文提示词。为了解决这一问题，我们借助 ChatGPT 实现了一个 Stable Diffusion 的提示词生成器（Prompt Generator），并搭建了一个将文本生成图片的服务，从而降低了 AI 绘画的门槛。具体特点包括：支持包括中文在内的多种语言提示词、支持智能优化与扩展提示词功能、只需输入少量关键词，即可生成效果不错的图片。</p>
<h4 id="02">02</h4>
<p>实现原理</p>
<h4 id="21-stable-diffusion">2.1 Stable Diffusion</h4>
<h4 id="211-简介">2.1.1 简介</h4>
<p>Stable Diffusion 是一个2022年发布的深度学习文本到图像的潜在扩散模型（LDM / Latent Diffusion Model），由 CompVis、Stability AI 和 LAION 的研究人员和工程师创建。它使用来自 LAION-5B 开源数据库子集的512x512图像进行训练，通过引入隐向量空间来解决 Diffusion 速度瓶颈，除了可用于文生图任务，还可以用于图生图、特定角色刻画，甚至是超分或者上色任务。本文不对其原理进行赘述，感兴趣的同学可以阅读原论文或相关文章。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tkFRsJ0BSFXjnckBgMI5RWv7Dd3ae2RmqdALk0GkEib01EOVcZN3JGaQ/640?wx_fmt=jpeg" alt=""></p>
<h4 id="heading"></h4>
<h4 id="212-如何部署">2.1.2 如何部署</h4>
<p>Stable Diffusion WebUI 有多种部署方式，这里介绍最简单的方式：Docker 部署。我们在一个8GB GPU 上就可以运行和体验该服务。只需要下面介绍具体的步骤：</p>
<p>*<strong>拉取 Github 代码</strong></p>
<ul>
<li></li>
</ul>
<pre><code>git clone https://github.com/AbdBarho/stable-diffusion-webui-docker.git
</code></pre>
<p>*<strong>运行</strong></p>
<hr>
<pre><code># 进入项目目录
cd stable-diffusion-webui-docker
# 下载相关模型
docker compose --profile download up --build
# 等待下载完成后，编译运行镜像
docker compose --profile auto up --build
</code></pre>
<p>*<strong>打开WebUI</strong></p>
<p>默认运行端口为7860，获取服务器 IP 后，在浏览器打开链接：http://{ip}:7860/. 页面如下所示：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tbPJUhH4aX1lUE1TKdYs8XkYelNE8un9ohb183OsdbR6lSms2lwxqibg/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>下载其他模型</strong></p>
<p>默认下载的 sd 模型是 v1.5 版本的，包括 v1-5-pruned-emaonly.ckpt 和 sd-v1-5-inpainting.ckpt。如果需要体验其他模型，可以先访问这个网站：https://civitai.com/ 。上面可以找到各种基于 sd 的开源模型和效果图，以及模型对应的点赞数、下载量和评价。可以根据业务需求或者点赞数/下载量来筛选模型，然后下载到部署的服务器上，sd 模型的存放路径为：</p>
<ul>
<li></li>
</ul>
<pre><code>stable-diffusion-webui-docker/data/StableDiffusion/
</code></pre>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tbxHAKBb33iaRsfu6ibJGGOZubp3QxJHCsBiaVuFB1Q888hqyyJ9kicD53Q/640?wx_fmt=jpeg" alt=""></p>
<p>我们 AI 绘画服务默认部署的是 DreamShaper 模型。</p>
<h4 id="22-prompt-generator">2.2 Prompt Generator</h4>
<p>Stable Diffusion 的提示词包括两种：正面和负面提示词。简单来说，正面提示词是你希望模型生成的图片内容，负面提示词是不希望模型生成的内容。例如，sd 不太擅长生成手，我们可以在负面提示词中加入“bad hands”、“missing fingers”、“extra fingers”等词。</p>
<p>本文中提到的提示词生成器，指的是正面提示词的自动生成。负面提示词相对来说比较简单和固定，一般没必要进行生成。我们使用的默认负面提示词如下：</p>
<ul>
<li></li>
</ul>
<pre><code>facelowres,bad anatomy,bad hands,text,error,missing fingers,extra digit,fewer digits,cropped,worst quality,low quality,normal quality,jpeg artifacts,signature,watermark,username,blurry,bad feet,ugly,duplicate,trannsexual,hermaphrodite,out of frame,extra fingers,mutated hands,poorly drawn hands,poorly drawn face,mutation,deformed,blurry,bad anatomy,bad proportions,extra limbs,cloned face,disfigured,more than 2 nipples,out of frame,ugly,extra limbs,bad anatomy,gross,worst quality,low quality,normal quality,signature,watermark,username,blurry,proportions,malformed limbs,missing arms,missing legs,extra arms,extra legs,mutated hands,fused fingers,too many fingers,long neck
</code></pre>
<p>如何基于 ChatGPT 实现 AI 绘画的提示词生成器？核心是 Prompt Engineering。提到 Prompt 工程，最近吴恩达教授与 OpenAI 合作推出的 《ChatGPT Prompt Engineering for Developers》教程面向入门 LLM 的开发者，深入浅出地介绍了对于开发者，如何构造 Prompt 并基于 OpenAI 提供的 API 实现包括总结、推断、转换等多种常用功能，是入门 LLM 开发的经典教程。本文会结合该教程，介绍 AI 绘画提示词生成器的最佳实践。</p>
<h4 id="221-背景知识">2.2.1 背景知识</h4>
<p>由于 ChatGPT 的训练数据只截止到2021年，有一些新的知识它是不知道的。因此我们对于一些特定的任务，我们需要提供一些背景知识给 ChatGPT。例如，一句话介绍什么是 Stable Diffusion。</p>
<ul>
<li></li>
</ul>
<pre><code>Stable Diffusion is an AI art generation model similar to DALLE-2.
</code></pre>
<h4 id="222-任务要求">2.2.2 任务要求</h4>
<p>吴恩达教授在教程的 Guidelines 中提到，Prompt 工程有两个原则：Write clear and specific instructions、Give the model time to “think”。</p>
<p>我们需要保证任务要求清晰和明确。对于复杂的任务，还需要将任务进行拆解，把一个综合任务拆解成若干个小的任务。例如，我们可以将该任务拆分成两个子任务。如下所示：</p>
<hr>
<pre><code>Please perform the following actions:
1. Translate the IDEA into English if it is not in English.
2. Write a detailed prompt exactly about the English IDEA follow the rules delimited by triple backticks.
Rules:
```
1. Follow the structure of the example prompts. This means Write a description of the scene, followed by modifiers divided by commas to alter the mood, style, lighting, and more, excluding the artist name, separated by commas.
2. Use at most 50 words.
```
</code></pre>
<p>大家可能会疑惑，这个任务不是挺简单的吗？为什么要拆解成两个子任务？不这样做会有什么影响吗？答案是：拆解任务会增加 ChatGPT 输出结果的可靠性和鲁棒性。因为我们在实验的过程中发现，对于中文提示词，如果不拆解任务，就算在 Prompt 中要求 ChatGPT 输出英文内容，有时候它还是会输出中文的结果。所以，如果要求 ChatGPT 先将用户输入的非英文提示词翻译成英文，再对英文提示词进行优化，输出的结果才会保证是英文的。</p>
<p>此外，ChatGPT 有时候会生成一大段文本，而内容太长反而会影响 AI 绘画的效果。因此，我们需要在 Prompt 中限制其返回结果的字数，对应上面的第二条规则：</p>
<ul>
<li></li>
</ul>
<pre><code>Use at most 50 words.
</code></pre>
<h4 id="223-合规性检查">2.2.3 合规性检查</h4>
<p>作为一个 AI 绘画服务，需要过滤/拒绝不合规的绘画提示词，避免 AI 生成不健康的内容。因此我们需要对提示词进行合规性检查，包括检查提示词是否包含色情、暴力、政治敏感、误导性、仇恨言论或歧视性语言等。ChatGPT 本身就有内容合规性判别的能力，我们可以借助它的能力来实现合规性检查，对于不满足要求的提示词直接返回某个错误代码（1004）。我们只需要在 prompt 中加入以下内容：</p>
<ul>
<li></li>
</ul>
<pre><code>If the IDEA is inappropriate or misleading or containing hate speech or discriminatory language, then simply write \&quot;1004\&quot;
</code></pre>
<h4 id="224-少量样本提示few-shot-prompting">2.2.4 少量样本提示（&ldquo;Few-shot&rdquo; prompting）</h4>
<p>为了让 ChatGPT 生成高质量的绘画提示词，我们可以提供少量样本/例子让它“学习”，即教程中所说的&quot;Few-shot&quot; prompting。该方法本质上是大语言模型（LLM）Fine-tune 的一种方式。样本不在多而在精，样本太多会增加 ChatGPT 的调用成本（按照 tokens 数量收费）。在样本数量有限的情况下，我们要尽量选择多样化的样本，使其覆盖尽可能多的场景。例如，我们可以提供以下几个样本（User 表示输入文本，Assistant 表示预期输出的内容）：</p>
<p>*<strong>样本1</strong></p>
<p>User: 一个弓箭手向森林怪兽射箭。</p>
<p>Assistant: portait of a homer simpson archer shooting arrow at forest monster, front game card, drark, marvel comics, dark, intricate, highly detailed, smooth, artstation, digital illustration.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tcuNfk38qTXMfjCwMtdnELG84bfG5LliarnnrB6F1ia1qJzGOWtTuxlqw/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>样本2</strong></p>
<p>User: 画一个海盗。</p>
<p>Assistant: pirate, concept art, deep focus, fantasy, intricate, highly detailed, digital painting, artstation, matte, sharp focus, illustration.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tbBEOZ6o0dIB16vlDGtawdedvAN1b8UlxcSNO77Wsva24NGt38edMmQ/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>样本3</strong></p>
<p>User: painting of rachel lane / alison brie, hybrid.</p>
<p>Assistant: a fantasy style portrait painting of rachel lane / alison brie hybrid in the style of francois boucher oil painting unreal 5 daz. rpg portrait, extremely detailed artgerm.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tTawguJDcxjddic0wKKib44mCrKTDkf3ul9vMcxS3Pj94EXsAibSrO3uJA/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>样本4</strong></p>
<p>User: 希腊女神雅典娜。</p>
<p>Assistant: athena, greek goddess, claudia black, art by artgerm and greg rutkowski and magali villeneuve, bronze greek armor, owl crown, d &amp; d, fantasy, intricate, portrait, highly detailed, headshot, digital painting, trending on artstation, concept art, sharp focus, illustration.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592toDgARf63YicV8fDaNcUiaZX3jibD0PS9SGQSeIRqgQwuzfqniaicuGqwEIw/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>样本5</strong></p>
<p>User: steve urkle as the hulk.</p>
<p>Assistant: ultra realistic illustration of steve urkle as the hulk, intricate, elegant, highly detailed, digital painting, artstation, concept art, smooth, sharp focus, illustration.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tI3xWibybic5hVRU08WAWMicicr62Z3gGyficxt47XcdWCITUH6T0jgjNDbg/640?wx_fmt=jpeg" alt=""></p>
<p>*<strong>样本6</strong></p>
<p>User: 落霞与孤鹜齐飞，秋水共长天一色。</p>
<p>Assistant: sunset with lone wild duck flying together, autumn water and sky merging into one color, traditional chinese landscape painting, ink wash, liu kuo-sung, guo xi, fan kuan, qi baishi, serene atmosphere, misty mountains, tranquil lake, vibrant colors, harmony with nature, poetic, calligraphy, trending on artstation, concept art, sharp focus, illustration.</p>
<p>绘图效果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tkicmibicX4Hq9EkrEWdtHsMhcaiauyQSqss6OFjLibdLNsXnqGBWvtVNQFA/640?wx_fmt=jpeg" alt=""></p>
<p>通过提供少量样本让 ChatGPT“学习”，可以提高模型输出的可靠性，提升 Prompt 的生成效果。</p>
<h4 id="225-小结">2.2.5 小结</h4>
<p>首先，我们提供任务相关的背景知识，让 ChatGPT 对任务有初步的了解。然后，对任务要求进行清晰和明确地描述，并且把相对复杂的任务拆分成两个子任务。此外，基于 ChatGPT 实现了提示词内容合规性检查，对不满足条件的请求进行拒绝。最后，为了提升效果，我们选取了几个不同风格的高质量样本让它“学习”，从而实现举一反三，提高输出结果的可靠性。</p>
<p>Prompt 工程不是一蹴而就的，需要根据需求不断迭代调试和实验，从而不断优化我们的 Prompt，提升最终效果。这也是教程中提到的 Iterative Prompt Develelopment。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tvZvIf4GgR44XrXqUqbnBKpIDwxSibq2NDt49dEhibTctb7O0V4ayL8yQ/640?wx_fmt=jpeg" alt=""></p>
<h4 id="03">03</h4>
<p>效果展示</p>
<p>这里展示几个例子，可以看出 Prompt 优化前后的效果对比：</p>
<h4 id="31-中国古代赛博朋克机械仙鹤">3.1 中国古代，赛博朋克，机械仙鹤</h4>
<p>优化前：cyberpunk mechanical crane in ancient China.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tFjIMWwC10KSQByWCicvh2PSGrhcJwyicdaX8p7VvKUVSXnF4prprC4Zw/640?wx_fmt=jpeg" alt=""></p>
<p>优化后：cyberpunk mechanical crane in ancient China, concept art, art by Johnson Ting, highly detailed, intricate, sharp focus, vivid colors, neon lights, futuristic, digital painting, trending on ArtStation, Unreal Engine 5, 4K UHD image, fantasy, sci-fi, mechanical, robotic, steampunk, industrial, cinematic, atmospheric, epic, breathtaking.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tqiaEpW8SHtBd33a1wzZEnT6UyBb9ahrEzKPcbe4ZKkdfGRD8UaQaldw/640?wx_fmt=jpeg" alt=""></p>
<h4 id="32-梵高风格塞尔达旷野之息">3.2 梵高风格，塞尔达旷野之息</h4>
<p>优化前：The Legend of Zelda: Breath of the Wild in the style of Vincent van Gogh.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592twLrIIrfnezxgpWR1icvObkgXIvZlo9XqfLI6Kk9OP23Z1eUV9VtFtZQ/640?wx_fmt=jpeg" alt=""></p>
<p>优化后：The Legend of Zelda: Breath of the Wild in the style of Vincent van Gogh, digital painting, art by Lois van Baarle, highly detailed, intricate, vibrant colors, bold brushstrokes, post-impressionist, art nouveau, inspired by Starry Night, landscape, trending on ArtStation, concept art, sharp focus, illustration.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592tldOzrtlJywbQn9IIs8FzwWoyaLSUbdgS6AKRCwMCjfLbgicvRQzvfug/640?wx_fmt=jpeg" alt=""></p>
<h4 id="33-春眠不觉晓处处闻啼鸟">3.3 春眠不觉晓，处处闻啼鸟</h4>
<p>优化前：Sleeping in Spring, Unaware of the Dawn, Birds Singing Everywhere.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592t6W6ZEQKmueo96RtuYPjeyJyl4fibRjtVgibodgqgBmsngMf7lAZtyTwA/640?wx_fmt=jpeg" alt=""></p>
<p>优化后：Sleeping in Spring, Unaware of the Dawn, Birds Singing Everywhere, traditional Chinese landscape painting, ink wash, Li Bai&rsquo;s poem, serene atmosphere, blooming flowers, lush trees, tranquil pond, poetic, calligraphy, trending on artstation, concept art, sharp focus, illustration.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592txWdvXAKCwROUyrLC8RicCJtrDjtPibLOribepdibSJmFp4erXI4cxOTMpg/640?wx_fmt=jpeg" alt=""></p>
<h4 id="34-天空之城">3.4 天空之城</h4>
<p>优化前：castle in the sky.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592t2BD72eaY8cnQDIyDljTQibY3O0SBZcA6j9fzAGibxeDEMeUVQNS4W1VQ/640?wx_fmt=jpeg" alt=""></p>
<p>优化后：castle in the sky, ghibli studio, hayao miyazaki, anime, floating island, steampunk, intricate, highly detailed, digital painting, artstation, matte, sharp focus, illustration.</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe978oGMxAh0S41ibbxyWk592t3xichYLmSXEdXtM6x8yLm83tfcVmvguIBNp5ibSBmaX1C2zibjywatvibw/640?wx_fmt=jpeg" alt=""></p>
<h4 id="04">04</h4>
<p>总结与展望</p>
<p>本文介绍了基于 ChatGPT 的 AI 绘图提示词生成器的实现原理，总结了大语言模型 Prompt 工程的一些实践经验。</p>
<p>我们知道，以 ChatGPT 为代表的大语言模型在很多领域都可以发挥巨大作用。但很多时候由于没有做好 Prompt 工程，任务需求描述得不够准确，或者没有提供有效的样本，导致模型的效果不够理想。作为 LLM 的使用者，我们需要利用 Prompt 来充分发挥出模型的潜力，从而提高业务的落地效果。</p>
<p>未来随着 LLM 和 AIGC 相关技术的发展，Prompt 工程可能会越来越简单，甚至在不久的将来可能都不需要 Prompt 工程，届时大语言模型已经足够聪明，我们只需要简单描述几句话它就能完成复杂的任务。但至少对于目前来说，Prompt 工程还是有必要的。欢迎在评论区中交流和探讨。</p>
<p>参考文献</p>
<p>Stable Diffusion</p>
<p><a href="https://github.com/CompVis/stable-diffusion">https://github.com/CompVis/stable-diffusion</a></p>
<p>High-Resolution Image Synthesis with Latent Diffusion Models</p>
<p><a href="https://arxiv.org/abs/2112.10752">https://arxiv.org/abs/2112.10752</a></p>
<p>Stable Diffusion WebUI Docker</p>
<p><a href="https://github.com/AbdBarho/stable-diffusion-webui-docker">https://github.com/AbdBarho/stable-diffusion-webui-docker</a></p>
<p>ChatGPT Prompt Engineering for Developers</p>
<p><a href="https://learn.deeplearning.ai/chatgpt-prompt-eng">https://learn.deeplearning.ai/chatgpt-prompt-eng</a></p>
<p>-End-</p>
<p>原创作者｜李派锐</p>
<p>技术责编｜郑海兵</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe979Bb4KNoEWxibDp8V9LPhyjmg15G7AJUBPjic4zgPw1IDPaOHDQqDNbBsWOSBqtgpeC2dvoO9EdZBQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe95wX1ueXdfknV9XnNcic65cW33md6Xeb29h6keWeUSfmasSibfrVUK8HDprqYaGcCpqdmcnia59YUtMA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe94ibOuGnfibic1RgxgMhmegDkzCTVH18nvibTJ6SU3H7myb8OEISPeP8hEFcwj4vN5rOSkofupR6M2YSg/640?wx_fmt=png" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe96DeDPficGXia6gYSXO1KtEbk1WVTHzCiaFRbsaYibfzIXaFg6NLNDl5PRReWljEv5OVrYSeFwkqWJ4AA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>关注并星标腾讯云开发者</p>
<p>第一时间看鹅厂技术</p>
<p>更多AI工具，参考<a href="https://ai123.869hr.uk/">Github-AI123</a>，<a href="https://ai123.869hr.uk/">国内AI123</a></p>



          </div>



<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


