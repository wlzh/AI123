

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>专为数据库打造：DB-GPT用私有化LLM技术定义数据库下一代交互方式 作者： 机器之心 来源： 机器之心 机器之心专栏 机器之心编辑部 DB-GPT 简化了这些基于大型语言模型 (LLM) 和数据库的应用程序的创建。 2023 年 6 月，蚂蚁集团发起了数据库领域的大模型框架 DB-GPT。DB-GPT 通过融合先进的大模型和数据库技术，能够系统化打造企业级智能  | AI123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AI123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://ai123.869hr.uk/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://ai123.869hr.uk/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AI123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">专为数据库打造：DB-GPT用私有化LLM技术定义数据库下一代交互方式</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://ai123.869hr.uk/about>AI123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              January 8, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCY7iaT3ibp4czDAdf5ick2OeJuv6JxDGQNGWQooLRV9LrYlXJFTbc9Klwg/640?wx_fmt=png&amp;from=appmsg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： 机器之心  来源： <a href="https://mp.weixin.qq.com/s/uRp-G80h_n-A9_ctuPFq4Q">机器之心</a></p>
<p>机器之心专栏</p>
<p><strong>机器之心编辑部</strong></p>
<blockquote>
<p>DB-GPT 简化了这些基于大型语言模型 (LLM) 和数据库的应用程序的创建。</p>
</blockquote>
<p>2023 年 6 月，蚂蚁集团发起了数据库领域的大模型框架 DB-GPT。DB-GPT 通过融合先进的大模型和数据库技术，能够系统化打造企业级智能知识库、自动生成商业智能（BI）报告分析系统（GBI），以及处理日常数据和报表生成等多元化应用场景。DB-GPT 开源项目发起人陈发强表示，“凭借大模型和数据库的有机结合，企业及开发者可以用更精简的代码来打造定制化的应用。我们期望 DB-GPT 能够构建大模型领域的基础设施，让围绕数据库构建大模型应用更简单，更方便”。据悉，DB-GPT 社区自成立以来，已汇聚了京东、美团、阿里巴巴、唯品会、蚂蚁集团等众多互联网企业的开发者共同参与，短短半年时间便迅速成长为一个近万星的开源社区，受到了行业和开发者的认可。期间也多次登上 GitHub Trending、Hacker News 首页。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCibOZMwwiauibXxTlwGr3ic1PEjEiaU69Xa2RMUuWnCvz99ZyDgb7OzEAR9w/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>如下是 DB-GPT 中的一些演示效果图：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCwx6XNTwkX0wJOr50nHZ2WBibSEf9kk5XqNINn9pVNfB2nmlCC1INq2g/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><em>图 1: 通过自然语言与数据库对话生成图表</em></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCCFQVnvmHFIlzQOASFCKTOd3YSmcfN7xU4j9xJ9MEqicQxXTbELfL2zQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><em>图 2：Excel 对话动态生成分析报表</em></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCNxGJVhia3OMN5iabiaOib804omw77J41ZxF2s1ShqXrnZDp7VgdlYibibKHg/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><em>图 3: 自然语言对话生成分析面板</em></p>
<p>在过去的六个月里，DB-GPT 项目的代码已经从最初提交第一行代码到当前版本 0.4.4，随着项目功能的精细打磨和版本的持续迭代，项目团队也随之发布了一篇关于 DB-GPT 的研究论文，该论文详细介绍了项目的核心技术，包括 RAG、多模型管理框架 SMMF、Text2SQL 的自动化微调以及基于数据驱动的 Multi-Agents 等关键特性的实现架构和实验对比。接下来，让我们了解下 DB-GPT 论文的相关内容:</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCLp78wwWnNflAYQH9nOWYPNHEHdROcAI0VYtokLa0SIER08c6eVabMw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<ul>
<li>
<p>论文地址：https://arxiv.org/pdf/2312.17449.pdf</p>
</li>
<li>
<p>论文代码：https://github.com/eosphoros-ai/DB-GPT</p>
</li>
<li>
<p>论文官网：https://dbgpt.site/</p>
</li>
<li>
<p>英文文档：https://docs.dbgpt.site/docs/overview</p>
</li>
<li>
<p>中文文档：https://www.yuque.com/eosphoros/dbgpt-docs/bex30nsv60ru0fmx</p>
</li>
</ul>
<p><strong>简介</strong></p>
<p>ChatGPT 和 GPT-4 等大型语言模型（LLMs）展示了它们在模拟人类对话和理解复杂查询方面的卓越天赋，同时引领了一个跨领域融合 LLMs 的新趋势。当这些模型和外部工具相结合，它们的能力得到进一步增强，使它们能够搜索互联网上的相关信息，同时可以利用外部工具创建更复杂、功能更丰富的应用程序。</p>
<p>在数据库领域，传统系统往往依赖技术专家的深厚知识和对领域特定的结构化查询语言 (SQL) 的熟练掌握来进行数据访问和操作。而 LLMs 的出现为自然语言接口铺平了道路，使用户能够通过自然语言查询和数据库进行交互，从而实现了数据库交互的简单化和直观化。</p>
<p>即便如此，如何巧妙地运用 LLM 增强数据库的操作性，以便打造功能强大的终端用户应用程序，仍然是一个悬而未决的难题。目前多数研究采用的一种直接方法，即直接使用常用的 LLM（例如 GPT-4）并通过简洁的少量示例提示（few-shot prompting）或交互式上下文学习（ICL）来进行交互。这一方法的优势在于，它不太可能过度拟合训练数据，并且能够灵活适应新数据，然而，其劣势在于与中型 LLM 的微调方案相比，性能可能尚未达到最佳。</p>
<p>此外，为了进一步促进与数据库的智能交互，众多研究和实践中已尝试将 LLM 支持的自动推理和决策过程（又名 agent）融入到数据库应用程序中。然而，知识代理（knowledge agent）往往是为特定场景和任务量身打造的，而非通用型，这一点限制了它们在广泛应用场景下的大规模使用。虽然在以 LLM 为核心的数据库交互中隐私保护措施至关重要，但这方面的深入研究仍显不足。以往的研究大多是普适性目标，而非针对数据库操作而精心设计的。</p>
<p>在此研究中，作者提出了 DB-GPT 框架，这是一个旨在借助 LLM 技术而打造的智能化、生产级的项目，它使用私有化技术提取、构建和访问数据库的数据。DB-GPT 不仅充分发挥了 LLM 的自然语言理解和生成的潜能，而且还通过 agent 代理和插件机制不断优化其数据驱动的引擎。表 1 展示了 DB-GPT 和 LangChain、LlamaIndex、PrivateGPT、ChatDB 等工具在多个维度的综合比较。综上所述，DB-GPT 具有以下明显优点：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCOPJ8dXp9Ze3icXTsAQbXlTbfGQAbG9nYYmT9IkshhicjqibB2TGcbmSPQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>隐私和安全保护</strong> 。DB-GPT 为用户提供了极致的部署灵活性，允许在个人设备或本地服务器上进行安装，并且能够在没有互联网连接的状态下运行。这确保了在任何时刻，数据都没有离开执行环境，彻底杜绝了数据泄露的风险。在数据处理模块，通过模糊数据集中的个人标识符，大幅度降低私人信息被未经授权访问和滥用的风险。</p>
<p><strong>多源知识库问答优化</strong> 。与传统的知识库问答系统（KBQA）相比，DB-GPT 设计构建了一条灵活、高效、支持双语的数据处理 pipeline，它能够将多源非结构化数据（例如：PDF、网页、图像等）摄取到中间数据中表示，随后将这些数据存储在结构化知识库中，在此基础上，系统能够高效检索和查询最相关的信息片段，并借助于其强大的自然语言生成能力，为用户提供详尽的自然语言回答。</p>
<p><strong>Text-to-SQL 微调</strong> 。为了进一步增强生成能力，DB-GPT 对 Text-to-SQL 任务的几个常用 LLM（例如 Llama-2、GLM）进行了微调，从而显著降低了非 SQL 专业知识的用户与数据交互的门槛。据作者了解，在同类研究中，有 LlamaIndex、SQLCoder 等集成了此类微调的替代方案，但它并未针对双语查询进行优化。</p>
<p><strong>集成知识代理（knowledge agent）和插件</strong> 。Agent 是一款自动推理和决策的引擎。DB-GPT 作为一个完全可用于生产环境的成熟项目，它赋能用户通过高级数据分析技术开发并部署应用会话代理，进而促进数据的交互式应用。此外，它还提供一系列查询和检索服务插件，用作与数据交互的工具。</p>
<p>论文对 DB-GPT 的性能进行了周密的评估，这不仅涵盖了各种基准任务（例如 Text-to-SQL 和 KBQA），还包括了案例研究和调查来评估其可用性和场景偏好。在多数评价指标上，DB-GPT 展现出了优于竞争对手的性能表现。</p>
<p><strong>系统设计</strong></p>
<p>DB-GPT 的整体流程如图 1 所示。在建立检索增强生成 (RAG) 框架时，DB-GPT 系统集成了新颖的训练和推理技术，显著增强了其整体性能和效率。本节将描述每个阶段的设计，包括模型架构以及训练和推理范式。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCTdabaMLZq4mibkX3xIT4eeibLYg3EuP1wGkOm41T1Yndv9victs6ahq4A/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>多源 RAG 知识问答</strong></p>
<p>尽管 LLM 通常在大量的开源数据或其他地方的独有数据上训练，但是仍然可以使用 RAG 技术通过额外的私人数据增强 LLM 知识问答能力。如图 2 所示，DB-GPT 的 RAG 系统架构由三个阶段组成：知识构建、知识检索和自适应上下文学习 (ICL)。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCQ1HVoj5SBQBPKJXzibwCr5JJHNj89kP47P4NW7mC92qCAKqRao2SVnQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>知识构建</strong> 。DB-GPT 的知识库是一个汇集自各个领域的庞大的文档<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCvI5MEtTDT8xkibfYUiae3uGH3dFYxWYAibkoQ2H5P8sKXqmgECXvxYnBA/640?wx_fmt=png&amp;from=appmsg" alt="">的集合，其中文档数量N很大。为了更加精细地处理这些信息，论文将每个文档<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCrAg0gYX5yZbpJ2r2HVrH8IpSSIrVEzdfSO71hqGyowW9Kkm1c4ibsrg/640?wx_fmt=png&amp;from=appmsg" alt="">分为多个段落<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCicXq32cQoERyv7p9suibEHnoSk1JCo0uINKrRDBD0n9loCUztmNOib5tQ/640?wx_fmt=png&amp;from=appmsg" alt="">，其中<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCU1feEF88zPNuSfjUZzRRBBicjrRSkibO8QmhehhL0ibV8vZw9AkMymbpw/640?wx_fmt=png&amp;from=appmsg" alt="">表示第 n 个文档的段落索引。随后，通过一个编码器 encoder<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCTV0FG4lTrNcDfnlZZonibqQ5ZpllicSBXMSbh6k8pZRdTXgiarlTMU7RQ/640?wx_fmt=png&amp;from=appmsg" alt="">将每个段落嵌入到多维的 embedding<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCY7iaT3ibp4czDAdf5ick2OeJuv6JxDGQNGWQooLRV9LrYlXJFTbc9Klwg/640?wx_fmt=png&amp;from=appmsg" alt="">。值得注意的是，DB-GPT 不仅采用了传统的基于向量的知识表示，还融入了倒排索引和图索引技术，使得用户能够迅速且精准地检索到与上下文相关的数据，如图 3 所示。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCU4iaicQyNEfV0FK8ibpNaXVHXoEZ59c6tosZyBMAAmgVZcwzVF46zZwDw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>知识检索</strong> 。当接收到语言查询x时，DB-GPT 通过另一个编码器 encoder<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPChxW58VtAG3rK1QDoFa6QYeNia5TFjO3gzCAEk9p4cCqBibBHc7b1nImA/640?wx_fmt=png&amp;from=appmsg" alt="">将x嵌入到向量 q 中。在此基础之上，DB-GPT 从知识库中检索前 K 个相关段落，其中K是超参数。如图 4 所示，DB-GPT 支持各种检索器模型，例如 Embedding Retriever（根据余弦相似度进行检索）、Keyword Retriever（其中匹配关键词而不是整个句子）。在下面的段落中，默认情况下使用 Embedding Retriever。</p>
<p><strong>学习嵌入和搜索</strong> 。得益于对编码器 <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCP0xWWMbwQ3grRg4FgVnFTIeNqGwHVlzlEGY2JDruESWd0q6UFGheCA/640?wx_fmt=png&amp;from=appmsg" alt="">和 <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCIibKOWHSeicapxA6vxgRd1CDZvzbY4qOISHqNIO5nrwSzhOYag9dZzXA/640?wx_fmt=png&amp;from=appmsg" alt="">的精确训练，DB-GPT 确信更高的相似性分数代表着与查询更为贴切的段落。直观上，真实相关的查询 - 段落对，它们的向量点积<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCDLOC37icOnhXwibDtDJEnDv5KoRicgIdhlmDVN0CO8sRoCQCsbk6AicTdQ/640?wx_fmt=png&amp;from=appmsg" alt="">相对较大。DB-GPT 的编码器 encoder 采用了 Multilingual-E5-base 模型架构，旨在优雅的实现双语文档的编码与处理。</p>
<p><strong>LLM 的自适应 ICL 和生成</strong> 。在这一阶段，DB-GPT 系统通过执行 ICL 来响应生成。系统首先根据和查询 query 的余弦相似度对 K 个搜索结果进行排序，然后选取排名最前的 J 个（其中 J ≤ K）结果，将这些结果插入到预定义的上下文提示模板中，最后 LLM 生成响应。ICL 是一种在训练或推理阶段通过在处理过程中纳入额外的上下文来提高 LLM 性能的技术。ICL 的引入不仅增强了语言模型对上下文的理解，还提高了模型的可解释和推理技能。值得注意的是，ICL 的性能很大程度上取决于特定的设置，包括提示模板、选择的示例、上下文示例的数量以及示例的顺序。在 DB-GPT 系统中，提供了多种制定提示模板的策略（示例见清单 1）以适应不同的需求。此外，论文采用了相应的隐私保护措施，确保个人信息得到妥善保存。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCRicEBwXGJ7JEDTpIOia8Pw58QRF6uE3Xcr4t3LCr5ibiaq1spibCibwPOtfQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>部署和推理：面向服务的多模型管理框架 SMMF</strong></p>
<p>模型即服务 (MaaS) 是一种云端的人工智能的服务模式，它向开发人员和企业提供即时可用的预配置、预训练的机器学习模型。在 DB-GPT 框架中，为了精简模型的适配流程，提升运作效率，并优化模型部署的性能表现，提出面向服务的多模型框架（SMMF）。该框架旨在为多模型部署和推理提供一个快速和便捷的平台。</p>
<p>SMMF 主要由模型推理层和模型部署层两个部分组成。模型推理层是一个专门为了适配多样化的 LLM 而设计的推理平台，包括 vLLM、文本生成推理 (TGI，HuggingFace 模型推理) 和 TensorRT。而模型部署层则承担着桥梁的角色，充当了底层推理层和上层模型服务功能之间的媒介。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCwiaCySvavCL5IgECZ25Mzr8VLtKa8a8ZC5icciaPLN53HnHSqH6oUwnuw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>模型部署层</strong> ：在 DB-GPT 的模型部署框架层内，一系列组件协同工作。由 API server 和 model handler 组成的任务负责向应用程序层提供强大的模型服务功能。model controller 占据中心位置，不仅负责元数据的治理，同时也充当大规模部署架构的纽带。此外，model worker 的作用至关重要，它直接与推理设备和底层基础环境直接连接，确保模型能够发挥最佳的性能。</p>
<p><strong>Multi-agent 策略</strong></p>
<p>DB-GPT 是一个多角色支持的系统，为数据分析师、软件工程师和数据库架构师等用户提供与数据库交互的全流程体验，同时配备了精心编排设计的标准操作程序（SOPs）。受到 MetaGPT 理念的启发，DB-GPT 为不同 agent 分配不同的角色，发挥其独特的优势和专长来解决具有挑战性的任务。通过精准的协调机制，DB-GPT 实现了不同 LLM agents 间的高效协作，促进它们之间沟通、共享信息和集体推理。基于 Text-to-SQL 微调后的 LLM，DB-GPT 可以快速开发和部署具有与数据库高级交互能力的智能 agent。此外，与适用于特定用例且行为受限的 LlamaIndex 组件不同，DB-GPT 使 agent 在更少的约束下具有更强的通用推理能力。</p>
<p><strong>数据库插件</strong></p>
<p>虽然 LLM 具有强大的能力，但它并非在每项任务上都能发挥最佳性能表现。LLM 可以通过合并插件来执行多个步骤，收集相关信息，而非直接回答问题。区别于通用的插件，DB-GPT 的插件专门为数据库交互模式而设计。这种设计有利于通过自然语言查询数据库，简化用户查询表达式，同时增强了 LLM 的查询理解和执行能力。数据库交互模式由模式分析器 (schema analyzer) 和查询执行器 (query executor) 两个组件组成。模式分析器 (schema analyzer)，负责将模式解析为 LLM 可以理解的结构化表达；查询执行器 (query executor)，则负责根据 LLM 的自然语言响应在数据库上执行相应的 SQL 查询。另外，DB-GPT 还与第三方服务集成，例如 WebGPT 中提出的 web search，用户无需离开聊天即可在另一个平台上执行任务。借助这些插件，DB-GPT 能够以强大的生成能力（论文将其称为生成数据分析）来执行多个端到端数据分析问题。具体详情可以参阅论文的说明性示例。</p>
<p><strong>模型训练</strong></p>
<p>RAG 的实现代码参考了开源项目 LangChain 的代码。Web 端的 UI 实现细节，可以参考作者的另一个开源项目：https://github.com/eosphoros-ai/DB-GPT-Web。其余的训练细节请参考原论文，或者访问 DB-GPT 开源项目地址：https://github.com/eosphoros-ai/DB-GPT，来获取更加全面准确的信息。</p>
<p><strong>实验</strong></p>
<p>论文中提出了旨在评估 DB-GPT 系统性能的实验，包括 Text-to-SQL 响应的生成质量和 MS-RAG 的 QA 性能，并提供生成数据分析的定性结果。</p>
<p><strong>Text-to-SQL 验证</strong></p>
<p>在公有数据集 Spider 上，本项目采用了 Text-to-SQL 的技术进行评估，其中训练使用 train 集，评估使用 dev 集。评估指标使用的是执行准确率（Execution Accuracy, 简称 EX）。该指标通过对比预测的 SQL 查询结果与特定数据库实例中的真实 SQL 查询结果来衡量。EX 越高，代表模型性能越好。考虑到双语文本支持需求，在 DB-GPT 框架实验中选取了 Qwen 系列和 Baichuan 系列作为基础的 LLM，实验结果如表 2 所示。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCAicke8L6A5ueic4RibVNve7gR8GXvOab4AYRJK4RMdvjLwmY5ia8IeyEAA/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>表 2 显示了 DB-GPT 系统在 Text-to-SQL 微调 pipeline 的有效性，无论是通义千问模型还是百川模型，微调后模型 EX 指标都有显著提升。</p>
<p><strong>RAG 验证</strong></p>
<p>论文在多种开放域问答（open-domain QA）任务中对 RAG 框架进行了实验。作者专门构建了两个 QA 数据集，分别聚焦于数据库领域和金融领域：DatabaseQA 和 FinancialQA。在构建 DatabaseQA 时，作者从三个代表性数据库系统（OceanBase、MySQL 和 MongoDB）中收集了 1000 个 PDF 形式的公开教程作为素材。而 FinancialQA 的素材则是从研究机构出版的文档样本中抽取了 1000 个。对于每个数据集，论文构建 100 个测试问题，这些问题均由专家根据难易程度进行注释。有关数据集的更多详细信息，请参阅论文附录。</p>
<p>为了确保答案质量评估准确性，论文指定三位专家对每个回复进行打分，评分范围为 0 – 5 分，其中较高分数代表更为优质的答案。评分结果取三位专家评分的平均值，以此作为最终得分。论文选取 4 个 LLM 作为基础模型，分别是：Qwen、Baichuan、ChatGLM 和 ChatGPT3.5。由于 ChatGPT3.5 并非开源模型，作者无法在框架中对其进行 Text-to-SQL 的微调。RAG 在两个数据集上的实验结果如表 3 和表 4 所示，在所有测试的数据集上，并没有一个模型能够在所有的情况下都胜出：ChatGPT-3.5 在 DatabaseQA 数据集上表现最佳，而 ChatGLM 在 FinancialQA 数据集上获得最佳性能。DB-GPT 集成了大部分流行的开源和商业 LLM，用户可以根据自己的 RAG 任务需求自由选择最适合的模型。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPC6BTy1VVLbNXXsCP713VaicbcgTTOSlEfNt8vupmNAKcB69sX60fABYA/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>SMMF 验证</strong></p>
<p>DB-GPT 集成了 vLLM 作为主要推理框架，实验过程中，为了保持一致性，论文将每一个输入提示（prompt）的长度固定为 8 个 token，并将输出的最大长度设置为 256 个 token。实验采用了以下三个评价指标：</p>
<ul>
<li>
<p>首字延迟 First Token Latency (FTL)：以毫秒为单位，代表 DB-GPT 模型部署框架收到请求时该时刻开始，到进行推理解码第一个 token 所花费的时间。</p>
</li>
<li>
<p>推理延迟 Inference Latency（IL）：以秒为单位测量，表示从 DB-GPT 模型部署框架接收到模型推理请求到生成完整的响应的时间。</p>
</li>
<li>
<p>吞吐量：DB-GPT 模型部署框架每秒中处理的所有用户和所有请求的 token 数量。</p>
</li>
</ul>
<p>Qwen 和 Baichuan 模型在 SMMF 方法上的实验结果如表 5 和表 6 所示，结果表明使用 vLLM 模型推理框架显著提高了模型的吞吐量，同时大幅度降低了首字延迟和推理延迟。值得注意的是，随着数量并发用户数增加，使用 vLLM 框架推理带来的性能提升变得特别明显。因此，DB-GPT 选择将 vLLM 集成为 SMMF 使用的默认推理框架。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPCfqbmqvsvH5fwG4Ip2anpotnTlWvH7qDpwiazo4nJm5j4Tz2ylpS6ycg/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>其他实验细节可以参考原论文附录。</p>
<p><strong>面向未来</strong></p>
<p>经过这一年的实践与抽象，为了具备更广泛的生产级应用能力，DB-GPT 对架构进行了分层。如下图所示，主要分为以下 7 层，自上而下以此为:</p>
<ul>
<li>
<p>可视化层：可视化层主要的工作是对话、交互、图表显示、可视化编排等能力。</p>
</li>
<li>
<p>应用层：基于底层能力的应用构建，如 GBI 应用、ChatDB 类应用、ChatData 类应用、ChatExcel 类应用等。</p>
</li>
<li>
<p>服务层：服务层主要是对外暴露的服务，比如 LLMServer、APIServer、RAGServer、dbgptserver 等。</p>
</li>
<li>
<p>核心模块层：核心模块主要有三个分别是，SMMF、RAGs、Agents。</p>
</li>
<li>
<p>协议层：协议层主要是指 AWEL (Agentic Workflow Expression Language), 即智能体编排语言，是专门为大模型应用开发设计的智能体工作流表达式语言。</p>
</li>
<li>
<p>训练层：训练层主要关注 Text2SQL、Text2DSL、Text2API 方向的微调，提供标准的微调脚手架。</p>
</li>
<li>
<p>运行环境：运行环境是指整个框架的运行在什么环境当中，我们后期会优先支持基于 Ray 与 Kubernetes 的环境。</p>
</li>
</ul>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW8nMO7tY8sbhvVXDj9SjZPC8f9cfcHDpSwkXia70o7ZNMby3mhWrsfcbtra3zclo6gHZb6AHVfErKQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><em>DB-GPT 整体架构设计图</em></p>
<p>用户可以基于这些基础框架能力，更好的打造生产级应用。更多关于 DB-GPT 的进展可以关注其社区。</p>
<p><strong>附录</strong></p>
<ul>
<li>
<p>DB-GPT 论文：DB-GPT: Empowering Database Interactions with Private Large Language Models.</p>
</li>
<li>
<p>DB-GPT 框架开源项目：https://github.com/eosphoros-ai/DB-GPT</p>
</li>
<li>
<p>DB-GPT 前端可视化项目：https://github.com/eosphoros-ai/DB-GPT-Web</p>
</li>
<li>
<p>DB-GPT Text2SQL 微调项目: <a href="https://github.com/eosphoros-ai/DB-GPT-Hub">https://github.com/eosphoros-ai/DB-GPT-Hub</a></p>
</li>
<li>
<p>DB-GPT 插件仓库: <a href="https://github.com/eosphoros-ai/DB-GPT-Plugins">https://github.com/eosphoros-ai/DB-GPT-Plugins</a></p>
</li>
<li>
<p>Text2SQL 学习资料与前沿跟踪: <a href="https://github.com/eosphoros-ai/Awesome-Text2SQL">https://github.com/eosphoros-ai/Awesome-Text2SQL</a></p>
</li>
</ul>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/KmXPKA19gW9LSvGJnGeMgN5icZW9coZAvicwuFyhFM09n7QicLPKzKr3WHYGIdVvlVUA20KPvDWYDKFKvXlXMz5XA/640?wx_fmt=png" alt=""></p>
<p>© THE END</p>
<p>转载请联系本公众号获得授权</p>
<p>投稿或寻求报道：content@jiqizhixin.com</p>
<p>更多AI工具，参考<a href="https://ai123.869hr.uk/">Github-AI123</a>，<a href="https://ai123.869hr.uk/">国内AI123</a></p>



          </div>

<<<<<<< HEAD

=======
 可扫如下微信二维码加好友
>>>>>>> HEAD@{1}

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


