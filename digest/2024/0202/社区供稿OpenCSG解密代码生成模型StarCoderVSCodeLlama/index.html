

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>社区供稿OpenCSG解密代码生成模型StarCoderVSCodeLlama 作者： Hugging Face 来源： Hugging Face 01 背景 2023年可以称之为大模型元年，也是AI模型在开源历史上最受关注的一年。各大企业、机构、高校纷纷发布了自研大模型，展示多年来AI能力的积累和从量变到质变的过程。大模型的出现突破了许多人对NLP、对AI算法的过往认识  | AI123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AI123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://ai123.869hr.uk/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://ai123.869hr.uk/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AI123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">社区供稿OpenCSG解密代码生成模型StarCoderVSCodeLlama</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://ai123.869hr.uk/about>AI123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              February 2, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWJibtfIicORCKJawo2ecnUQibzTlAg3cXWxYsVhMpLdTY17edr0ibXRSF4Q/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： Hugging Face  来源： <a href="https://mp.weixin.qq.com/s/w_R5bZop1GaHLmTwS0SZsA">Hugging Face</a></p>
<p><strong>01</strong></p>
<p><strong>背景</strong></p>
<p>2023年可以称之为大模型元年，也是AI模型在开源历史上最受关注的一年。各大企业、机构、高校纷纷发布了自研大模型，展示多年来AI能力的积累和从量变到质变的过程。大模型的出现突破了许多人对NLP、对AI算法的过往认识，越来越多的人开始相信大模型能够很好的理解人类自然语言并与人类交互，人工智能离我们更近了一大步。当然，大模型的能力不仅如此，它甚至可以读懂程序员以及机器生成的代码。</p>
<p>代码数据是高度逻辑思维下的产物，是信息时代的精粹，是计算机领域人与人之间、人与机器之间的连接纽带。解决好大模型的代码能力，就能解决好大模型与所有计算机信息系统的交互问题。目前大语言模型 (LLM) 已经发展到了熟练掌握自然语言的程度，通过在特定领域的数据集上进行训练，可以进一步衍生出各种下游任务。</p>
<p>其中一个应用便是基于代码训练的 LLMs (Code LLMs)，通过与模型的交互，由自然语言指令进行程序合成、代码补全、代码调试和生成文档。<strong>生成式代码大模型可以提高代码工作者的工作效率，对未来的计算机产业产生深远影响。目前，微软的 Copilot 已经吸引了超过100万的代码开发人员，GitHub报告指出，这些开发者依赖Copilot编写了 35% 的代码。</strong></p>
<p>在这种背景下，HuggingFace BigCode团队和Meta团队也分别推出了自己的开源代码大模型：StarCoder和CodeLlama。本文我们会详细介绍这两种模型的技术细节，复现HumanEval benchmark评测结果以及横向对比两类模型在实际应用（题解生成、代码补全、单元测试）中的生成效果。</p>
<p>除此之外，<strong>OpenCSG算法团队分别将两类模型作为基座模型，在精选的优质数据集上进行微调训练。相比于原版的starcoder，codellama系列模型，微调后的opencsg-starcoder, opencsg-codellama模型，在HumanEval python pass@1 benchmark上均有一定程度的提升，这些结果也同时证明了StarCoder和CodeLlama模型具备较大的潜力，为我们团队后续在开源社区贡献更强大的代码生成模型打下坚实的基础。</strong></p>
<p><strong>02</strong></p>
<p><strong>深入了解StarCoder模型</strong></p>
<p>StarCoder系列模型是由 Hugging Face 和 ServiceNow 共同领导的开源项目组织 BigCode 所建立，该组织致力于开发代码大模型 (CodeLLM)，于2023年5月推出了 StarCoder 和 StarCoderBase 两个模型，具有 8K 上下文长度、填充 (infilling) 功能和快速大批量推理能力。</p>
<p>其中 StarCoderBase 使用 1 万亿个 token 进行训练，训练数据来源于 GitHub 上的授权数据，其中包括 86 种编程语言、Jupyter笔记本、GitHub issues和 commits，StarCoder 是使用35B的python token数据在基础模型 StarCoderBase 上微调而成。接下来让我们来逐步解密Starcoder模型的产生细节吧。</p>
<p><strong>解密StarCoder预训练数据管理和清洗</strong></p>
<p>BigCode团队对StarCoder模型的训练数据做了非常清晰介绍及解释。这一部分我们会讨论starcoder在训练数据集的选择，不同代码数据的清洗处理方式，不同语言在训练数据集中的采样分布以及数据去重等内容。</p>
<p><strong>训练集</strong></p>
<p>StarCoder 和 StarCoderBase 的训练集来自于公开数据集 The Stack v1.2 (<a href="https://huggingface.co/datasets/bigcode/the-stack">https://huggingface.co/datasets/bigcode/the-stack</a>)，其中包含 6TB 的授权数据，覆盖358种编程语言。</p>
<p>StarCoder团队经过启发式过滤、人工检查筛选、清洗等处理之后还剩余 783GB 的代码数据，包含86种编程语言，其中有54GB的github issues数据和13GB jupyter notebook脚本和text-code数据对，32GB 的github commits数据，总计将近250B tokens。Bigcode组织秉承开源精神公开了清洗后的数据集——Starcoderdata (<a href="https://huggingface.co/datasets/bigcode/starcoderdata">https://huggingface.co/datasets/bigcode/starcoderdata</a>)。</p>
<p><strong>数据选择</strong></p>
<p>StarCoder团队从 The Stack 公开代码数据集的 358 种编程语言中选择了 86 种语言，并根据文件扩展名对编程语言分类，保留超过 500 MB，以及在 Github 2.0 或 2022 年 12 月 TIOBE 编程语言流行度指数上排名前 50 的语言，其中也包含了像JSON 和 YAML 等数据文件，但对这方面的数据做了数量限制以平衡整个数据集的分布，并且剔除了配置语言 (如Nix、Puppet 等)以及已经被时代废弃的的语言如ActionScript。Starcoder团队对不同类型的编程语言有个性化的处理逻辑，下文我们进一步分析了具体的处理方法。</p>
<p><strong>人工检查</strong></p>
<p>为了筛选出高质量的数据，StarCoder团队通过人工检查的方式进行数据处理。首先从 The Stack 数据集中为每种编程语言随机选择 30,000 个文件，按扩展名对它们进行分类，并为每个扩展名保留最多 1,000 个文件。StarCoder团队招募了一些标注员，指导他们抽样检查其中 50-100 个文件，确认是否是人类编写的正常代码，而不是文本、数据或一长串自动生成的代码。标注员需要确定是否应该对某一种语言使用字母数字过滤器 (要求有超过 25% 的字母数字符号) 和长行文本过滤器 (要求每行少于 1,000 个字符) 。</p>
<p><strong>XML 过滤器</strong></p>
<p>StarCoder 团队实现了一个简单的 XML 过滤器，用于检查文件的前 100 个字符中是否存在**“&lt;?xml version=”** 。使用此工具对除了 XSLT （XSLT 语法与 XML 相同）之外的所有编程语言进行过滤。</p>
<p><strong>字母过滤器</strong></p>
<p>在代码数据场景中，像MATLAB 类型的数据中通常有大量包含大型tensor的数据文件。为了过滤这种文件，StarCoder 团队开发了一个字母过滤器，可以删除字母字符少于 25% 的文件。但是这个过滤器在某些编程语言 (例如汇编语言) 中的误报率很高，所以团队最后决定重点关注检测次数最多的 25 个编程语言，并通过人工确认是否应该在此编程语言上应用字母过滤器。</p>
<p><strong>HTML 过滤器</strong></p>
<p>Starcoder团队设计了一个 HTML 过滤器，只保留可见文本至少占 20% 且最小长度为 100 个字符的文件。这样可以避免保留下来的文档中出现过多 HTML 标签和链接。</p>
<p><strong>JSON and YAML 清理</strong></p>
<p>对于 YAML 文件，保留 50-5000 个字符、平均行长度小于 100、最大行长度小于 1000，并且字母字符超过 50% 的文件，这使得 YAML 文件减少了大约 20% 的文件和 90% 的体积。类似地，对于 JSON 文件，保留 50-5000 个字符且超过 50% 字母字符的文件，这使得 JSON 文件减少了大约 70% 的文件和 98% 的体积。</p>
<p><strong>Jupyter</strong></p>
<p>Jupyter笔记本的数据主要包括两种：</p>
<p>1.第一种是 Jupyter scripts，使用 Jupytext 工具将笔记本转换为 Jupyter scripts。从每个笔记本的meta信息里可以获取编程语言类别，Jupytext可以根据这个信息识别不同语言的代码段。但是有超过 30,000 个笔记本缺少编程语言信息，所以StarCoder团队结合使用了 Guesslang 工具进行识别，该工具使用了机器学习方法识别代码片段所属的编程语言。</p>
<p>2.第二种是 Jupyter – structured，创建这类数据首先需要过滤掉不包含 Python 代码也不包含 Markdown 文本的笔记本，只有meta信息中明确标记为“Python”语言的笔记本会被留下。在每个笔记本内部，连续的 Markdown 块或代码块会合并为一个大的 Markdown 或代码块，最终得到连续的按时间顺序排列的代码-文本对。包含 Python 代码的代码块与 Markdown 文本紧邻，形成天然的指令对。</p>
<p><strong>GitHub issues</strong></p>
<p>从 The Stack v1.2 中收集来自 GitHub issues 和 pull request 的自然语言对话，每个对话都包含一系列操作事件，例如开启问题、创建评论和关闭问题。每个事件都包括作者的用户名、消息、操作和创建日期。删除了用户通过电子邮件回复问题时自动生成的文本，也删除了少于 200 个字符的问题。删除机器人生成的评论，机器人生成的问题往往很长，并且包含大量日志和链接。按照参与对话的用户数量进行过滤，保留两个及两个以上数量用户的对话，最后使用 fasttext 工具过滤掉非英语的问题。</p>
<p><strong>Git commits</strong></p>
<p>由于这部分数据会包含用户提交的更改前以及更改后大量重复的代码片段，为了避免模型在学习相同内容上花费过多的计算资源，StarCoder团队决定仅在 20% 的时间内使用完整文件，而在其余 80% 的时间内，对第一个和最后一个更改行周围的 0 到 32 行之间的窗口进行采样。</p>
<p><strong>去重处理</strong></p>
<p>Starcoder团队在去重方法上首先采用了MinHash，即计算所有代码文件的 MinHashes，然后使用本地敏感哈希 (LSH) 将相似的代码文件映射到同一存储桶。对所有编程语言和 Jupyter 笔记本都进行了去重，但是由于时间限制没有应用于 Git commits。不过 Git commits 不太可能发现重复项，所以StarCoder团队认为这部分数据不需要进行去重。</p>
<p><strong>数据集的权重</strong></p>
<p>一般地，数量比较多的数据基本都来自于相对更流行的编程语言，StarCoder团队认为不需要对现有的数据分布进行大幅度的重新加权，在训练过程中按照数据的原始分布比例对数据源进行采样，这样训练出来的模型也能够照顾到这些流行语言的用户。但在这其中 JSON、YAML 和 CSS 格式是例外，因为 LLM 应该重点学习这些语言的数据格式，而不是浪费计算资源来记住其中的数据。所以StarCoder团队重新分配了这几种语言的大小，JSON 和 YAML 为 1 GB，CSS 为 3 GB。</p>
<p><strong>StarCoder模型训练方法和技巧</strong></p>
<p>在上文我们了解了预训练数据的准备流程后，我们再来了解一下StarCoder模型在训练过程当中运用的具体方法，涉及数据格式构造、Tokenizer选择以及模型框架搭建。</p>
<p><strong>数据格式</strong></p>
<p>在这部分我们会详细介绍StarCoder团队如何构造预训练数据的格式，其中**<token>** 指的是特殊令牌 (special token)，<strong>metadata</strong> 和<strong>data</strong> 则是数据字段的占位符。</p>
<p><strong>代码</strong></p>
<p>代码部分的数据一共包含三个meta信息和代码正文 (code)，meta信息分别为存储库名称 (reponame)、文件名 (filename) 以及星级 (stars)，格式为**<reponame><strong><strong>reponame</strong></strong><filename><strong><strong>filename</strong></strong>&lt;gh_stars&gt;<strong><strong>stars</strong></strong>\n<strong><strong>code</strong></strong>&lt;|endoftext|&gt;******</p>
<p>StarCoder 将meta信息添加到代码文件的上下文中。为了使模型能够在没有meta信息的情况下进行推理，这三类meta信息被独立添加前缀，概率均为 0.2。将中间填充变换 (Fill-in-the-Middle Transformation, FIM) 以字符级应用于源代码文件，覆盖率为0.5，其中一半使用前缀-后缀-中间 (prefix-suffix-middle, PSM) 模式，一半使用后缀-前缀-中间 (suffix-prefix-middle, SPM) 模式。</p>
<p><strong>GitHub issues</strong></p>
<p>GitHub上面的每个仓库 (repository) 都有“错误跟踪器”，称为“issues”，供仓库创建者、贡献者、使用者或任何想参与讨论的人在使用开源项目发现代码bug或出现问题时使用。一个 GitHub issues 实例见下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWzdScNfaWjIaCNf7ibA8ic617SQOQ9ENyo8QEyicunEwqkW8QM1v8hvDYA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>这部分数据被处理为以下格式：</p>
<p><strong>&lt;issue_start&gt;Title:<strong><strong>title</strong></strong>\nusername</strong>**_id0****:<strong><strong>comment0</strong></strong>&lt;issue_comment&gt;**<strong>username_id1:<strong><strong>comment1</strong></strong> &hellip; &lt;issue_closed(optional)&gt; &lt;|endoftext|&gt;</strong></p>
<p>通过**&lt;issue_comment&gt;** 来分离一系列评论，并在评论前放置一个匿名化的说话人标识符。为了区分不同对话轮，使用comment1，id1分别指代第二个评论和与之对应的匿名说话人id。</p>
<p><strong>Jupyter</strong></p>
<p>1.Jupyter – scripts</p>
<p>Jupyter - scripts 是由Jupyter笔记本转换为脚本文件而得。内容形式如下 (以ipynb为例)。</p>
<p>1.# example_notebook.ipynb</p>
<p>2.</p>
<p>3.# %%</p>
<p>4.print(&ldquo;Hello, Jupyter-Script!&rdquo;)</p>
<p>5.</p>
<p>6.# %%</p>
<p>7.name = &ldquo;Amelia</p>
<p>8.&ldquo;print(f&quot;Welcome, {name}!&rdquo;)</p>
<p>9.</p>
<p>这部分的数据结构与代码部分结构相同：<strong><reponame>reponame<filename>filename&lt;gh_stars&gt;stars\ncode&lt;|endoftext|&gt;</strong></p>
<p>2.Jupyter – structured</p>
<p>Jupyter – structured 部分的数据包含 Python 代码块和与之相邻的 Markdown 文本，形成天然的指令对，其格式为</p>
<p><strong>&lt;jupyter_start&gt;&lt;jupyter_text&gt;text0&lt;jupyter_code&gt;code0&lt;jupyter_output&gt;output0&lt;jupyter_text&gt; &hellip; &lt;|endoftext|&gt;</strong></p>
<p>解析出来的 Jupyter 笔记本以文本 (text)、代码 (code) 和输出 (output) 为链，以标记每一对 text-code-output 的开始，text2，code2，output2 用来指代笔记本中的第3个三元组。</p>
<p><strong>Git commits</strong></p>
<p>在 Git 管理中，“commits”（提交）是一种保存项目更改的方式。每个提交都代表了项目在某一时间点的状态，包含了文件的变更信息。提交可以记录编程者对项目所做的修改，包括添加、删除或修改文件。一个 Git commit 实例见下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmW8eIbGONXwpzJ9c51UHcsODZLfHXjWK6jYXMDQKJNogKcINHbvVBwrA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>这部分数据被处理为以下格式：</p>
<p><strong>&lt;commit_before&gt;code_before&lt;commit_msg&gt;<strong><strong>message</strong></strong>&lt;commit_after&gt;<strong><strong>code_after</strong></strong>&lt;|endoftext|&gt;</strong></p>
<p>以 commit_before、commit_msg 和 commit_after 为链。以 20% 的概率使用完整文件，不使用完整文件的时候就在变化的行周围使用一个小窗口 (0 ~ 32行)。</p>
<p><strong>分词器</strong></p>
<p>StarCoder 使用 Hugging Face Tokenizers 库训练一个字节级的字节对编码 (BBPE)的分词器，共49152个token。</p>
<p><strong>模型框架</strong></p>
<p>StarCoder 采用与 SantaCoder 架构相同的15.5 B参数模型。它是一个 decoder-only 的 Transformer，运用多查询注意力 (MQA)，学习绝对位置embedding。将中间填充 (Fill-in-the-Middle, FIM) 变换应用在训练数据上，并使用Flash Attention 来加速注意力计算并减少其内存占用，使得上下文长度可以扩展到8K。</p>
<p><strong>StarCoder模型评测详解</strong></p>
<p>StarCoder 团队列出了包括 StarCoder 和 StarCoderBase 等一些模型在 Human Eval、MBPP 和 DS - 1000 benchmark上的Python语言得分，同时也评测了多种编程语言的benchmark。</p>
<p><strong>StarCoder: Python Evaluation</strong></p>
<p><strong>HumanEval和MBPP基准</strong></p>
<p>StarCoder 团队将 StarCoder 和 StarCoderBase 与几种模型在 HumanEval 和 MBPP 基准上进行了比较。测试结果如下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWdn0GJeobBUKIpdj3eB3NIATCibr2Thnyiao4oYgicLzjq1GicZ6nUfPTibA/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>可以看到，在这两个基准上进行测试的结果中，StarCoder 是表中分数最高的开源模型。尽管StarCoder的规模比PaLM，LaMDA和LLaMA等模型的规模小很多，但是其分数却优于这些规模较大的模型。StarCoderBase 对 Python 的理解也很出色，与 CodeGen-16B-Mono (一个在Python上微调的类似大小的开源模型) 不相上下。同时，StarCoder 也优于 OpenAI 推出的 code-cushman-001 (12B) 模型。</p>
<p><strong>DS-1000 python数据科学基准</strong></p>
<p>HumanEval 和 MBPP 的局限性在于它们只包含编程题，而编程题中的代码并不能代表大多数程序员所写的代码。相比之下，DS-1000 更贴近实际应用中会出现的代码，它涵盖了7个Python库 (如NumPy、Pandas等) 的相关问题和答案。测试结果如下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWREfA3UDxodGaVmNvH9Uia29s7knkWWuQSl1XOTrmJ2CfN9H60RgP0Rw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>从 DS-1000 基准来看，StarCoder 在数据科学问题上的表现优于 StarCoderBase，二者同时远远优于其他所有模型。与此同时，StarCoder团队还有进一步的发现：在 HumanEval 和 MBPP 基准测试中性能表现好的模型并不一定能在 DS-1000 基准测试中拥有同样好的表现。例如，CodeGen-Mono 在 HumanEval 和 MBPP 上的性能略优于 code-cushman-001 和 StarCoder 模型，但在 DS-1000 上明显较差。这证明了在一系列基准上评估模型的重要性。</p>
<p><strong>The ODEX 开放域编程基准 (Open-Domain Coding Benchmark)</strong></p>
<p>上文评估要么侧重于封闭域 (例如内置 Python 函数，如 MBPP 和 HumanEval基准) ，要么侧重于特定域 (例如数据科学，如 DS-1000基准) 。为了更广泛评估模型在 Python 库上生成代码的能力，StarCoder 团队使用 ODEX 基准进一步进行测试，测试集包含 505 个开放域和 440 个封闭域 Python 编程问题，采用四种自然语言——英语、西班牙语、日语和俄语——基于测试用例进行评估。测试结果如下。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWKtfytaV4SVDEOfoZsOE6aTy6wWgULsWRSfqPJ7pjd9eWIuwbar1w9g/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder 在开放域编程方面远远优于所有其他模型。StarCoderBase 紧随其后，其性能也优于其他所有模型，甚至在 ODEX 英语子集中优于 StarCoder，但在其他语言中稍微落后。</p>
<p><strong>StarCoder and StarCoderBase: Multi-Language Evaluation</strong></p>
<p>尽管 StarCoder 是在 Python 上进行微调得到的，但它仍是一个非常强大的多语言代码 LLM，甚至在某些语言上的表现优于 StarCoderBase。</p>
<p><strong>使用 MultiPL-E 在 19 种编程语言上进行评估</strong></p>
<p>StarCoder 团队使用 MultiPL-E 评测集评估 StarCoder 将自然语言转换为多种编程语言的能力。MultiPL-E 将 HumanEval 和 MBPP 中的 Python 语言翻译成了其他 18 种编程语言。各模型在总共19种编程语言上的表现如下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWWTyt6vZ8ican9LMKM8CtMj66cWIv3lPIyA59hqLRXYY2KDr2Rkn1f1g/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>从所有 19 种编程语言测试的结果整体来看，StarCoderBase 的性能优于其他开源模型，有时甚至表现出超过 2 倍的性能。除了少部分语言，StarCoderBase 与 code-cushman-001 的表现不相上下。与此同时，尽管 StarCoder 是在 Python 上进行微调得到的，但其在大多数语言上的表现仍然很出色，优于其他开源模型，甚至 StarCoder 在某些语言上的表现要略胜于 StarCoderBase。</p>
<p><strong>“Asleep at the Keyboard” 安全基准</strong></p>
<p>代码大模型的一个局限性在于它们有可能生成具有安全漏洞的代码。Asleep at the Keyboard 基准包含 89 个与安全相关的情景以供测试。测试结果如下。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmW0ricrk2DaVNPln2SIRjHZnh9ibxMhH9Ww7a0GiaSkSR6MErXJ6kCwxyZw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoderBase 的代码有效率最高。InCoder-6B 的不安全代码生成率略低，但这可能是由于其代码有效率较低。在有效代码超过 95% 的模型中，StarCoder 的不安全率最低。</p>
<p><strong>Fill in the Middle 基准</strong></p>
<p>StarCoder 模型支持中间填充 (Fill in the Middle, FIM) ，即模型根据前后文 (prefix, suffix) 在插入点周围进行代码生成。StarCoder团队根据4个FIM基准进行了测试。</p>
<p>(1) Python、Java 和 JavaScript 的单行填充</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWr9HnANA8KNwaN3IP8zzLf5kMl5twOiat0slcBYia0RpYHiacokTwBB6VA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoderBase 的性能明显优于其他两个规模较小的模型。</p>
<p>(2) Python 返回类型预测</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWEF2Gial16GQYP1sKyMr2rGTwRZFTldht0rQwd36K1lxCjw2COB8ClYQ/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder 和 StarCoderBase 在 Python 返回类型预测方面优于其他模型。但是由于该评测集中的函数取自 GitHub 存储库，因此它们可能与 SantaCoder 和 StarCoder 模型的训练数据重叠。</p>
<p>(3) TypeScript 类型预测</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWpSyQ5gB37eiaTWrecf2icPepUicZib6zZe6icENJOscibr4GegspdiaEyHb1A/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoderBase 的表现优于 InCoder。</p>
<p>(4) Python Docstring 生成</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWRwibwMhqEmicBpU8nmX8OrQFzz4ApiaGLU6ws7DF0A4BOUL9242ia7otSw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder 和 StarCoderBase 在docstring生成方面有更好的表现。但此评估数据集与用于训练 SantaCoder 和 StarCoder 模型的数据之间可能存在重叠。</p>
<p><strong>StarCoder 如何保障数据隐私安全？</strong></p>
<p>StarCoder 采用一种个人身份信息修正 (Personally Identifiable Information redaction, PII redaction) 机制，从训练数据中删除个人身份信息。收集并标注 PII 数据集，将其用于 PII 检测模型的训练，最终得到 PII 检测模型。</p>
<p><strong>数据收集</strong></p>
<p>Starcoder团队召集了来自 35 个国家的 1,399 名众包人员来注释源代码中的 PII 数据集。PII 类型包括姓名、用户名、电子邮件、IP 地址、密钥、密码和用户名。</p>
<p><strong>数据组成</strong></p>
<p>PII 数据集包括 12,000 个文件，31 种编程语言，每个文件包含大约 50 行代码。在这其中，为了增加密钥、IP地址等稀有 PII 类型的代表性，团队预过滤了7100个文件，使用 detect-secrets 工具以及正则表达式来检测电子邮件、IPv4和IPv6地址。为了防止标注结果过度依赖检测工具，还从数据集中随机选择了没有进行过预过滤的5100个文件。</p>
<p><strong>区分 PII</strong></p>
<p>根据 PII 出现的上下文来区分 PII 是否需要被掩盖，包括是否存在于代码的许可证头中、是否被用作占位符以及是否构成机密数据。之所以要进行这样的区分，是因为许可证中的 PII 通常是由作者自愿提供的，而占位符也没有私密性，所以出现在这两处的 PII 都不需要被掩盖。只需将这种区分应用于姓名、电子邮件、用户名。</p>
<p><strong>质量评估</strong></p>
<p>Starcoder团队通过人工检查了300个包含各种 PII 类型的文件，并计算了每种类型的查全率和查准率。标注用户名经常出现错误标注，所以StarCoder团队决定将该类别排除在 PII 检测模型训练之外。</p>
<p><strong>StarEncoder</strong></p>
<p>StarCoder 为了 PII 检测专门训练了一个 encoder-only 模型，可以有效地针对代码和文本相关的任务进行微调。使用 BERT 中的基于掩盖的语言模型 (Masked Language Model, MLM) 和下句预测任务 (Next Sentence Prediction, NSP)，预测输入句子中被盖住的 token 以及一对输入是否是文章中前后文。</p>
<p><strong>PII 检测模型</strong></p>
<p>PII 检测的总体思路是命名实体识别 (Named Entity Recognition, NER)。用标注过的 PII 数据集对 StarEncoder 进行微调。在模型顶部添加了一个线性层作为分类头，有6个目标类：姓名、电子邮件、密钥、密码、IP地址和用户名。</p>
<p><strong>PII 占位符</strong></p>
<p>占位符分别有**<NAME>, <EMAIL>, <KEY>, <PASSWORD>。**</p>
<p>至于 IP 地址的占位，从5个合成出来的私有 IP 地址中随机选择一个同类 IP 地址进行替换。</p>
<p><strong>03</strong></p>
<p><strong>深入了解Code Llama模型</strong></p>
<p>2023年08月，Meta 发布了 Code Llama，它是基于 Llama 2 衍生出来的代码生成模型，在开源模型中具有先进的填充能力、长上下文输入能力以及在编程任务中的 zero-shot 能力。它可以降低代码工作的门槛，辅助开发人员写出完善且高质量的代码，成为生产力工具和教育工具。</p>
<p>Code Llama系列模型 有多个版本：</p>
<ul>
<li>
<p>基础模型（Code Llama）</p>
</li>
<li>
<p>Python专业化版本（Code Llama - Python）</p>
</li>
<li>
<p>指令跟随模型（Code Llama - Instruct）</p>
</li>
</ul>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWgNWbEfqlp25Fe5OTibQAaI4PuCIaWQtlibtFPZGlC5wke4BjqhtDlyxA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>每个版本都分别有三个尺寸，参数量各为7B、13B和34B，并支持多种编程语言。所有模型都是在16k token序列上进行训练的，并稳定支持最高10万个token的上下文生成。7B 和 13B 的 Code Llama 以及 Code Llama - Instruct 支持基于周围内容的填充。7B模型适合在单个GPU上运行，34B模型则提供了更好的编程辅助效果，但是相比较之下速度较慢。在面对比如实时代码补全这种低延迟轻量任务，更适合使用速度较快量级的7B和13B模型。</p>
<p>Code Llama 在多个代码基准测试中达到了开放模型中的最先进性能，分别在 HumanEval 和 MBPP 上取得了高达 53%和 55% 的分数 (优于 Llama2 70B)，在 MultiPL-E 评测中的精度优于所有开源模型。</p>
<p>Meta 的方法是通过应用一系列训练和微调逐步提高 Llama 2 模型的能力并逐渐将其专业化。在预算相同的情况下，使用 Llama 2 初始化模型优于仅针对代码数据进行预训练的相同架构的模型。</p>
<p><strong>解密CodeLlama微调方案</strong></p>
<p>正如上文所介绍，CodeLlama通过一系列的训练和微调逐步提升模型能力，包括填充、长文本微调和指令微调。</p>
<p><strong>填充</strong></p>
<p>代码填充是指在给定周围上下文的情况下预测缺失部分。其应用包括代码补全、类型推断和生成代码内文档 (比如docstring) 。</p>
<p>按照因果掩码 (Causal Masking) 的概念来训练填充模型，序列的一部分被移到末尾，重新排序后的序列进行自回归预测。将训练数据在字符级别分成前缀 (prefix)、中间部分 (middle) 和后缀 (suffix)。分割位置在文档长度上从均匀分布中独立采样，采样概率为 0.9。随机将一半的分割以前缀-中间-后缀 (Prefix-Suffix-Middle, PSM) 格式进行格式化，将另一半以后缀-前缀-中间 (Suffix-Prefix-Middle, SPM) 格式进行格式化。</p>
<p><strong>长文本微调</strong></p>
<p>Code Llama 创建了一个长上下文微调 (LCFT) 阶段，模型的输入长度为 16,384 个 token的序列，比 Llama2 和初始代码训练阶段所使用的 4,096 个 token 要多。通过将处理长序列的训练时间限制在微调阶段，可以在不显著增加模型训练成本的情况下获得处理长距离注意的能力。</p>
<p>在使用旋转位置嵌入时，旋转频率的设置十分重要。Code Llama 改变了旋转位置嵌入 (rotary position embedding, RoPE) 的基础周期：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWHjvHUojuKqibeicu0Mu5GMfUicatickjmzgXKTpE1farDSwFUemE1A381w/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>其中 n 表示位置，d 表示 embedding 维度，旋转频率的计算公式为 θi = θ^(−2i/d).</p>
<p>基础周期 θ 从 10,000 增加到 1,000,000，这样可以处理更长的序列并减少对短距离注意力的偏见。实验证实，Code Llama 模型不仅在微调过程中的序列长度内有效，而且还显示出外推能力，在 100,000 个 token 的超长序列上表现稳定。</p>
<p><strong>指令微调</strong></p>
<p>指令微调主要有三种数据集来源，专用数据集、self-instruct数据集以及代码与自然语言组合数据集。</p>
<p><strong>(1) 专有数据集</strong></p>
<p>采用 Llama2 中的 RLHF V5 版本数据集，该数据集包括数千个监督微调 (Supervised Fine-Tuning) 示例和数百万个拒绝采样 (Rejection Sampling) 示例。每个示例由用户 (user) 和助手 (assistant) 之间的多轮对话组成。</p>
<p><strong>(2)Self-instruct 数据集</strong></p>
<p>Meta 构建了约 14,000 个问题-测试-解决方案(question-tests-solution)三元组。构建方法如下：</p>
<ul>
<li>
<p>通过提示 Llama 2 70B，生成 62,000 个面试形式的编程问题；</p>
</li>
<li>
<p>通过删除完全重复项来去除重复的问题集，从而剩下约 52,000 个问题；</p>
</li>
<li>
<p>对于每一个问题：</p>
</li>
<li>
<p>通过提示 Code Llama 7B 生成单元测试 (unit tests)；</p>
</li>
<li>
<p>通过提示 Code Llama 7B 生成十个Python解决方案；</p>
</li>
<li>
<p>对这十个解决方案进行单元测试，将通过测试的第一个解决方案（及其相应的问题和测试）添加到 Self-instruct 数据集。</p>
</li>
</ul>
<p>使用 Code Llama 7B 生成单元测试和解决方案的原因是它所消耗的计算资源更低，而且效果已经令人满意。</p>
<p><strong>(3) 代码和自然语言组合数据集</strong></p>
<p>为了防止模型在编程和语言理解能力方面出现退化，Code Llama - Instruct 使用代码数据集 (6%) 和自然语言数据集 (2%) 的配比的方式来进行训练。</p>
<p><strong>CodeLlama的训练细节详解</strong></p>
<p><strong>优化参数设置</strong></p>
<ul>
<li>
<p>使用 AdamW 优化器，其中 β1 设置为 0.9，β2 设置为 0.95.</p>
</li>
<li>
<p>具有 1000 个预热步骤的余弦学习率，并将最终学习率设置为峰值学习率的 1/30.</p>
</li>
<li>
<p>batch size 是 4M 个 token，每 4, 096 个 token 为一个序列。</p>
</li>
<li>
<p>Meta团队并没有选择普遍使用的标准做法——在微调阶段使用比预训练阶段更低的学习率，而是保留 Llama 2 基础模型的原始学习率，经过试验发现这种做法可以获得最佳结果。</p>
</li>
<li>
<p>将这种做法应用于 13B 和 34B 模型，学习率分别设置为 3e^−4 和 1.5e^−4.</p>
</li>
<li>
<p>对于 python 微调，将初始学习率设置为 1e^−4.</p>
</li>
<li>
<p>Code Llama - Instruct 的 batch 大小是 524,288 个 token，总计 5B 个token。</p>
</li>
</ul>
<p><strong>长上下文微调 (Long context fine-tuning, LCFT)</strong></p>
<ul>
<li>
<p>使用 2e^−5 的学习率，16,384 的序列长度，并使用 θ = 10^6 的基值来重置 RoPE 频率。</p>
</li>
<li>
<p>对于 7B 模型和 13B 模型，batch 大小设置为 2M 个 token；对于 34B 模型，batch size 设置为 1M 个 token。</p>
</li>
<li>
<p>默认情况下，训练有 10,000 个梯度步骤。有些时候会出现下游性能不稳定的情况，因此将 34B 模型的梯度步数设置为 11,000，将 Code Llama 7B 的梯度步数设置为 3,000。</p>
</li>
</ul>
<p><strong>CodeLlama模型评测</strong></p>
<p>Code Llama 34B 模型在 HumanEval 评测中取得了 53.7% 的通过率，在 MBPP 评测中的通过率则达到了 56.2%，接近 Chatgpt 的水平。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWywDCrD9Cdr9XnxFibhplStd05mOblibO45qgqKcH6CBtHW34LDOvlXHg/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><strong>CodeLlama 如何保障模型安全？</strong></p>
<p>Meta分别从诚实性 (Truthfulness)、有害性 (Toxicity) 和偏见 (Bias) 的角度用三个基准对 CodeLlama 的安全性进行了评估。</p>
<p>诚实性：使用 Truthful QA 来衡量模型的事实性和常识性。Truthful QA 基准包括817个问题，涵盖健康、金融、法律和政治等主题。这其中的有些问题十分具有挑战性，甚至人类在没有依据或者认知上存在错误的情况下也会答错。</p>
<p>有害性：使用 ToxiGen 来量化一段话具有危害性的程度，以及带有何种程度的仇恨。ToxiGen 数据集包含13个少数群体的隐性有害和良性句子。使用默认的 ToxiGen 分类器来衡量大模型产生输出的有害性。</p>
<p>偏见：使用开放语言生成数据集 (Bias in Open-Ended Language Generation Dataset, BOLD) 来研究模型输出所包含的情感。</p>
<p>测试结果如下图。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWzzIkicSFYElz9MKzPJedIcUbZECAxuAyIfCWicl4BvXeYcGJ1UWWUe7Q/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>可以看到，微调后的 Code Llama - Instruct 在诚实性和有害性方面的表现比预训练的 Code Llama 更好。所有版本的 Code Llama 有害内容占比都低至几乎为 0%，在所有进行比较的模型中有害性最低。与 Falcon 和 MPT 微调模型相比，微调后的 Code Llama 在有害性和诚实性方面均表现出次优水平，仅次于 Llama 2 Chat。除此之外，Code Llama - Instruct 在微调后也表现出正向情感的整体增加。</p>
<p><strong>04</strong></p>
<p><strong>StarCoder 和 CodeLlama 谁更适合作为基座模型？</strong></p>
<p>StarCoder和CodeLlama是两种训练路线的生成代码模型。</p>
<p>StarCoderBase的预训练数据几乎全是代码数据，是从零开始预训练起来的代码生成模型；而CodeLlama是在Llama2通用模型上用代码数据微调而成。</p>
<p>在没有基于自然语言模型进行微调的基础上，StarCoder也表现出了不凡的自然语言理解能力。除此之外，StarCoder数据更加透明，利用opt-out机制让用户可以自行选择将自己仓库中的代码数据排除在数据集之外，数据安全性更高。</p>
<p>而CodeLlama用来训练的数据以及对于数据进行处理的细节都没有公开，具有不确定性，用户无法清楚得知有哪些数据被包含在模型训练当中以及在这个过程中该团队是如何保障数据隐私安全的。虽然CodeLlama对模型进行了数据安全的基准测试，但是这些基准都有其局限性，所以并不能完全证明CodeLlama具有全面的数据安全性。</p>
<p>单一评测基准经常有“偏好”上的局限性，因此在多个基准上评估模型非常重要。StarCoder团队在评测模型性能的时候就曾有发现：在 HumanEval 和 MBPP 基准测试中性能表现好的模型并不一定能在 DS-1000 基准测试中拥有同样好的表现。</p>
<p>例如，CodeGen-Mono 在 HumanEval 和 MBPP 上的性能略优于 code-cushman-001 和 StarCoder 模型，但在 DS-1000 上明显较差。不同评测基准难免具有自己的“偏见”，导致了评测结果的片面，在做模型评测的时候应该运用多种品测基准，且要辩证地看待评测结果。</p>
<p><strong>StarCoder与CodeLlama 在HumanEval benchmark上的评测对比</strong></p>
<p>OpenCSG团队深入研究了StarCoder以及CodeLlama这两种不同的代码生成模型训练方法，并且对StarCoder和CodeLlama系列模型进行了评测复现，结果如下表。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWdoYDKhSyJJAoTAJ2uwXUE1ypR1zkaAID1rCmU1MpDuOOeKdfcMLqJw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>从结果可以看出，CodeLlama在HumanEval python pass@1的表现是随着模型的参数量增加，评测分数也逐步提升，其分数甚至高于starcoder这样的优秀代码生成模型。OpenCSG分析StarCoder分数不高的原因的是其对于humanEval这样做代码题解的评测问题上没有进一步的微调，它更加侧重于解决代码领域内通用的问题。</p>
<p>而CodeLlama通过Python专有数据微调过的codellama-13b-python和codellama-34b-python模型在HumanEval - Python评测中的表现都要更好，由此可见专用数据对于模型在垂类领域能力提升至关重要。</p>
<p><strong>StarCoder与CodeLlama 在实际应用中的比较</strong></p>
<p>除了评测之外，OpenCSG团队基于实际应用场景，在题解生成、代码补全和生成单元测试三个方面对StarCoder和CodeLlama-13b的生成结果进行了比较。</p>
<p><strong>1.题解生成</strong></p>
<p>(1) 生成快排算法</p>
<p>测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWQpVzicbjDHYMHrcdQw0MTz85qNJ167Be3yuhFuR5iaH9RfUIde6wcI5w/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWbbKA7bmgpVLhNMflOcwBsS2gBey8CsjVDs73ocYWPqiaCWZ10Er1bjg/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWJyC6iadQyAxHzbWXmhdJp3ggTXqicsDV66McEFoHeI2BkmvV4jWGAfrg/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>两个模型虽然生成的有细节上的区别，但是经过测试都是合理正确的快排算法。在这个问题上可以说表现一致。</p>
<p>(2) 生成检查有效数独算法</p>
<p>测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWsibwrhvKCj2STkvd5TIV4kpic4iaJicyfNe7PwYCvwICiawXT733vJk9BqQ/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWJibtfIicORCKJawo2ecnUQibzTlAg3cXWxYsVhMpLdTY17edr0ibXRSF4Q/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWqBZE9IPd5Ur35c3CZK0eQ077pnRrueRjFDeT4TzsKfZqibPgIKz9ibaw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWeibZr6ic6lsJIicYcgIbCzWmyMNDpD21yGibuic2MdgOPMUZldiakynqIvBA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>两个模型在算法代码题上的生成都很完整且正确。</p>
<p><strong>2.代码补全</strong></p>
<p>CodeLlama-13b-hf模型的测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWX187DlKiaHdNsSLaibtczlut9VhgiaIsgOH5ddWReJVBCJjd8gBiaxMULw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWb6AfU9Mjb1MmibxZrXym21T0on0uhicumKjxz2ZzmMcdZIM2S8HnrKog/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWuxyD38gyDJpicXjc8j0IzmbtK7wsDvS6qDzBSjc0jVopCBBdPpdKJcg/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWQuz5Er5vUI9yibSnTHZjENxS2Pv9XgGE1mW44KALuavTzmP2lQpicSMA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>由于两个模型所使用的special token不相同，所以两份测试代码输入表示略有不同，两个模型对于快排算法补全的结果都是正确的。</p>
<p><strong>3.生成单元测试</strong></p>
<p>(1) 用英文注释作为prompt给快排函数生成单元测试</p>
<p>测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWcoNYBvsBPWZ622Y0LibcQuzHQQSSKia615Ga9Dr0S4O9u9LtXoTfXvSw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWHFrq93mKIVq7aUT0NSp7GFqRYpDrGJjQbv00ibN0Rpia20PXMXMhicHcg/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWzwAydkdFcHLCzHqZgicDHY1AKFKDZFbPvTzVOvNUbblAjBPmkOAEr3w/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-Python-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWeY37TR3kvkTNrKUOe5xibhndWEePYfsfGSkfF0UXH356N8TfEXias8BQ/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>在单元测试生成问题上，StarCoder成功理解了“只生成一个测试用例”中的“一个”，而 CodeLlama-13b 试图在设定的输出长度里持续输出多个测试用例。在这个测试中，StarCoder表现出了比 CodeLlama 更好的对自然语言（英语）的理解能力。</p>
<p>但同时我们也注意到，StarCoder生成的测试用例不如CodeLlama-13b-Python合理，该问题是一个排序算法，立项的生成结果应该为乱序的数组更为合理，而CodeLlama-13b-Python首先生成了乱序的数组，再对快排算法进行结果测试。</p>
<p>我们接下来测试了用中文进行prompt的结果。</p>
<p>(2) 用中文注释作为prompt给快排函数生成单元测试</p>
<p>测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWYoCcicbEYPvhWIlC4ibl9ZIib2p7DUwxdeETWxjSczfLohuJByPTpUylw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWibZn6I5h4iaf4rjsiaz6vUcHV6zvYKGcqqP8yaC7vJMCNEIs8UX1sxzoQ/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWktFE2Nhficgvibpiaze9DeYAdBhwrN70X2GEOzc5P7wIb7x4ptTV9yicIw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-Python-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmW0yJbr9fO1MbmrDnDY86e5BegQwNI8vV36ibV0dIJrOKNlC23TqTgNaw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>可以从CodeLlama-13b-hf的输出发现它极度依赖于用于训练的原始数据，用户的隐私信息也没有做合适的处理；而相比之下，专门处理过PII Redaction的StarCoder模型就不太会出现这种情况。</p>
<p>除此之外，在StarCoder的生成中，中文prompt生成的测试用例比英文prompt生成的测试用例更为合理——用于进行测试的数组应为乱序数组。</p>
<p>CodeLlama-13b-Python依旧是生成单元测试最合理的模型，比CodeLlama-13b生成的结果合理、完整很多，这说明在通用语言模型上训练而成的CodeLlama十分需要专业化的数据对模型专业化生成能力进行提升。</p>
<p>(3) 给打印“Hello world!”函数生成单元测试</p>
<p>测试代码：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWGZwJXdNicibxTth2KnN6hXAInEaibHVPFNibveqFWlwGcAxDh6KrxwCoMw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWCWLzx5oocXKORzpUYMJLs5QiaHaUicZict1Is2G2ibfJ8H9yfhJYN6hv1w/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>StarCoder模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWQWV8YvVduSxic28cbZ8XM9fCCgzFkFwK2Zm3nKtThB0qS0PSkwgTbGw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>CodeLlama-13b-Python-hf模型的生成结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWhrmye2QUH6WuDOs4JR9bef5MCn2lP8AARlT3CzhsEbDDNaGUDUdEYQ/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>可以看到StarCoder模型和CodeLlama-13b-Python模型生成的代码较CodeLlama-13b更为合理。这进一步说明了CodeLlama对更专业化的数据十分data-hungry。</p>
<p><strong>OpenCSG微调模型</strong></p>
<p>OpenCSG团队用同一份包含多语言的精选题解数据集分别在 StarCoder 和 CodeLlama模型 上进行微调测试，结果如下表。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/ZC2neNoyG74KjZjAWE44cIpC4XkEXBmWbotJrY41gfVEib2n6WIOJQsTUj1TKQSgNq9zQYGiaAunRfbticibphicZIA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p><strong>从上述结果可以看出，经过OpenCSG模型团队微调过的opencsg-StarCoder-v0.1模型, opencsg-codellama-7b-v0.1模型, opencsg-codellama-13b-v0.1模型, opencsg-codellama-34b-v0.1 模型这四个模型在HumanEval python pass@1 这个benchmark上均比原版的模型分数更高一些。</strong></p>
<p>这个结果不仅是体现了StarCoder和CodeLlama还存在极大的性能提升的潜力，可用于训练的代码数据远远没有耗尽。</p>
<p>OpenCSG作为一家大模型开源社区，我们平台提供丰富的开源训练数据资产、模型资产可以供广大的爱好者免费获取。</p>
<p>同时，OpenCSG算法团队也会持续跟踪starcoder和codellama后续微调模型的工作，通过开源的方式不断迭代微调模型能力，也欢迎广大模型训练爱好者加入我们社区一起共建、共享、共同提升，以下是公司介绍以及联系OpenCSG的方式。</p>
<p>OpenCSG中 Open是开源开放；C 代表 Converged resources，整合和充分利用的混合异构资源优势，算力降本增效；S 代表 Software Refinement，重新定义软件的交付方式，通过大模型驱动软件开发，人力降本增效；G 代表 Generative LM，大众化、普惠化和民主化的可商用的开源生成式大模型。</p>
<p>OpenCSG的愿景是让每个行业、每个公司、每个人都拥有自己的模型。我们坚持开源开放的原则，将OpenCSG的大模型软件栈开源到社区。欢迎使用、反馈和参与共建，欢迎关注和Star⭐️，以下是和OpenCSG团队的沟通方式：</p>
<p>huggingface社区：<strong><a href="https://hf.co/opencsg">https://hf.co/opencsg</a></strong></p>
<p>OpenCSG社区：<strong><a href="https://www.opencsg.com/">https://www.opencsg.com/</a></strong></p>
<p>Github社区：<strong><a href="https://github.com/OpenCSGs">https://github.com/OpenCSGs</a></strong></p>
<p><strong>参考链接</strong></p>
<p>1.StarCoder: 最先进的代码大模型</p>
<p><a href="https://huggingface.co/blog/zh/StarCoder">https://huggingface.co/blog/zh/StarCoder</a></p>
<p>2.StarCoder: A State-of-the-Art LLM for Code</p>
<p><a href="https://huggingface.co/blog/StarCoder">https://huggingface.co/blog/StarCoder</a></p>
<p>3.Creating a Coding Assistant with StarCoder</p>
<p><a href="https://huggingface.co/blog/starchat-alpha">https://huggingface.co/blog/starchat-alpha</a></p>
<p>4.使用StarCoder创建一个编程助手</p>
<p><a href="https://huggingface.co/blog/zh/starchat-alpha">https://huggingface.co/blog/zh/starchat-alpha</a></p>
<p>5.StarCoder Memorization Experiment Highlights Privacy Risks of Fine-Tuning On Code</p>
<p><a href="https://huggingface.co/blog/dhuynh95/StarCoder-memorization-experiment">https://huggingface.co/blog/dhuynh95/StarCoder-memorization-experiment</a></p>
<p>6.Code Llama: Open Foundation Models for Code</p>
<p><a href="https://arxiv.org/abs/2308.12950">https://arxiv.org/abs/2308.12950</a></p>
<p>7.StarCoder: may the source be with you!</p>
<p><a href="https://arxiv.org/abs/2305.06161v2">https://arxiv.org/abs/2305.06161v2</a></p>
<h4 id="heading"></h4>
<p>本文由 Hugging Face 中文社区内容共建项目提供，稿件由社区成员投稿，经授权发布于 Hugging Face 公众号。文章内容不代表官方立场，文中介绍的产品和服务等均不构成投资建议。了解更多请关注公众号:</p>
<p>如果你有与开源 AI、Hugging Face 相关的技术和实践分享内容，以及最新的开源 AI 项目发布，希望通过我们分享给更多 AI 从业者和开发者们，请通过下面的链接投稿与我们取得联系:</p>
<p><a href="https://hf.link/tougao">https://hf.link/tougao</a></p>
<p>更多AI工具，参考<a href="https://ai123.869hr.uk/">Github-AI123</a>，<a href="https://ai123.869hr.uk/">国内AI123</a></p>



          </div>

 可扫如下微信二维码加好友

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


