

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>GLM4介绍 作者： AINLP 来源： AINLP GLM-4 2024年1月16日，智谱AI正式推出GLM-4新一代基座大模型，整体性能相比ChatGLM3全面提升60%，根据实际测试，GLM-4在以中文为主的应用场景中实际性能逼近GPT-4的95%，在一些中文对齐的测试中，甚至超过  | AI123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AI123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://ai123.869hr.uk/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://ai123.869hr.uk/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AI123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">GLM4介绍</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://ai123.869hr.uk/about>AI123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              February 6, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFSz9EsSrlIYJNss5e9txT0ofbuXiaaecDJmWwG67ic1Zfd8cW5ITwSGBQ/640?wx_fmt=png&amp;from=appmsg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： AINLP  来源： <a href="https://mp.weixin.qq.com/s/7DkiOX91FJfb5kLNw0Ua-A">AINLP</a></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJuK8UUBxdZXj1c20hUg374YPgXibgDGytAy87YxvVk4WCRFWrdKJPshStrlPJp4vGEGUQodxt7ibOw/640?wx_fmt=jpeg" alt=""></p>
<h4 id="glm-4">GLM-4</h4>
<p>2024年1月16日，智谱AI正式推出GLM-4新一代基座大模型，整体性能相比ChatGLM3全面提升60%，根据实际测试，GLM-4在以中文为主的应用场景中实际性能逼近GPT-4的95%，在一些中文对齐的测试中，甚至超过GPT-4-turbo。</p>
<p>此外，GLM-4支持128K对话上下文，并且支持更强的多模态功能、支持更快推理速度，更多并发，大大降低推理成本;</p>
<p>同时GLM-4增强了智能体 (<strong>Agent</strong> )能力。</p>
<p>和此前ChatGLM3模型所不同的是，GLM-4不再采用开源模式，而是采用了OpenAI和Google大模型的<strong>在线大模型模式</strong> ，即模型无需本地部署，而是通过联网的方式调用智谱算力中心的模型进行推理或微调，用户通过API-KEY进行身份验证，同时根据实际使用模型不同、以及不同的Token数量进行计费。</p>
<p>具体可以访问 智谱AI大模型MaaS开放平台</p>
<p>包含了完整详细的GLM在线系列模型调用方法、API手册、说明文档、以及对标OpenAI Playground的在 线调用模型实验环境。</p>
<h4 id="glm模型生态">GLM模型生态</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFAQVoAqSQLj8ibTCbRMmCQT6jPh5R9iaNO5zgL5PGYTI0XaicGv445I76w/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<ul>
<li>
<p>文本生成模型</p>
<ul>
<li>
<p>GLM-4 对标GPT-4</p>
</li>
<li>
<p>GLM-3-Turbo 对标GPT-3.5</p>
</li>
</ul>
</li>
<li>
<p>强化角色扮演的文本生成模型(CharGLM-3)</p>
</li>
<li>
<p>多模态图像创建模型(CogView-3) 对标DALL·E-3模型</p>
</li>
<li>
<p>Embedding-2模型 对标OpenAI的text-Embedding-ada-2模型</p>
</li>
</ul>
<p>从ChatGLM3开始，GLM系列模型已经支持 Function calling功能</p>
<p>将来，智谱AI还将进一步开放GLM-4v多模态大模型，用于进行图像识别，对标GPT-4v;以及计划将发布GLM-4-Assistant API，用于更高效率进行Agent开发，对标OpenAI Assistant API。</p>
<h4 id="知识库">知识库</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFGHEPl7LJdZWSTKtuvG7rGkYDPTR7IicibWlyQf5dsOVKEKrWPYdozdLg/640?wx_fmt=png&amp;from=appmsg" alt="">和OpenAI File system类似，智谱AI也为其在线大模型技术生态设置了在线知识库搭建功能。所谓在线知识库，指的是用户可以将一些本地文档存在智谱AI的云端，用于随时将这些知识库文档输入大模型，或作为微调数据带入在线微调流程:</p>
<p>在实际使用大模型时，若要调用在线知识库中文档进行读取，我们只需要在调用模型API时设置Retrevial功能即可。此时大模型即会根据外部文档进行回答</p>
<p><strong>用法</strong> 在智谱开放平台创建知识库后后得到知识库 ID，调用接口时传入知识库ID，将自动对文档进行分块、索引和存储嵌入，并通过向量搜索来检索相关内容来回答用户查询。</p>
<pre><code>from zhipuai import ZhipuAI  
client = ZhipuAI(api_key=&quot;&quot;) # 请填写您自己的APIKey  
response = client.chat.completions.create(  
    model=&quot;glm-4&quot;,  # 填写需要调用的模型名称  
    messages=[  
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;你好！你叫什么名字&quot;},  
    ],  
    tools=[  
            {  
                &quot;type&quot;: &quot;retrieval&quot;,  
                &quot;retrieval&quot;: {  
                    &quot;knowledge_id&quot;: &quot;your knowledge id&quot;，  
                    &quot;prompt_template&quot;:&quot;从文档\n  
                    &quot;&quot;&quot;\n  
                    {{knowledge}}\n  
                    &quot;&quot;&quot;\n  
                    中找问题\n  
                    &quot;&quot;&quot;\n  
                    {{question}}\n  
                    &quot;&quot;&quot;\n  
                    的答案，找到答案就仅使用文档语句回答，找不到答案就用自身知识回答并告诉用户该信息不是来自文档。\n  
  
                    不要复述问题，直接开始回答。&quot;  
                }  
            }  
            ],  
    stream=True,  
)  
for chunk in response:  
    print(chunk.choices[0].delta)  
</code></pre>
<p>需要注意的是，模型内部实现的<strong>Retrevial功能并不是长文本问答，既输入的内容不能超过模型最大上下文限制</strong> ，因此模型内部的 Retrevial基本可以理解为将一个文档输入为system message，然后引导模型基于system message进行回答。不过未来即将上线的GLM-4 Assistant API将会和OpenAI Assistant API一样，支持大范围长文档的自动检索和问答。可以说目前知识库 系统也是为未来GLM-4 Assistant API做准备。</p>
<h4 id="online-finetuning">online finetuning</h4>
<p>对于“闭源”的在线大模型来说，由于并未在本地进行安装部署，所以微调这一功能只能在模型云端完成。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFmB4mjiayQk4X36I2sCU0QjabT2pkialicqOVcvrOYtVtE7qnSKXPS5AdQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>微调数据格式：</p>
<pre><code>{&quot;messages&quot;: [{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一位乐于助人，知识渊博的全能AI助手。&quot;},{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请介绍一下AlphaGo的基本原理。&quot;}, {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;AlphaGo利用深度神经网络与树搜索算法相结合,通过对弈数据进行训练,逐步提升游戏水平,能够对围棋局面进行判断并选择最佳落子位置。&quot;}]}  
{&quot;messages&quot;: [{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一位乐于助人，知识渊博的全能AI助手。&quot;},{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请列举一些健康饮食的重要原则。&quot;}, {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;健康饮食的重要原则包括:膳食应营养均衡,合理摄入各种营养素;多吃新鲜蔬果,适量饮水;少吃糖、油、盐,忌吃过量快餐;养成规律生活作息习惯,适量运动。&quot;}]}  
{&quot;messages&quot;: [{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一位乐于助人，知识渊博的全能AI助手。&quot;},{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请给出一些改善睡眠质量的建议。&quot;}, {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;改善睡眠质量的建议包括:保证睡眠时间,避免睡眠不足;睡前放松身心,远离刺激;养成规律作息时间,不要频繁熬夜;适量运动,但不要运动过度;睡前可以喝一杯热牛奶等温和饮料。&quot;}]}  
</code></pre>
<p>创建微调任务：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFzhyACzWBib62DyzAO5bLPic22iaAP0fSW8N874W8YKXodcjBwtYwtibp6g/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>调用微调后的模型：</p>
<pre><code>from zhipuai import ZhipuAI  
client = ZhipuAI(api_key=&quot;&quot;)  
response = client.chat.completions.create(  
    model=&quot;chatglm3-6b-1001&quot;,  # 填写需要调用的模型名称  
    messages=[  
        {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一个人工智能助手，你叫叫chatGLM&quot;},  
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;你好！你叫什么名字&quot;},  
    ],  
    stream=True,  
)  
for chunk in response:  
    print(chunk.choices[0].delta)  
</code></pre>
<p>除了上面介绍的两个能力retrieval和finetuning，文档中还有function calling的介绍，感兴趣的可以查看https://open.bigmodel.cn/dev/howuse/functioncall</p>
<p>同时还提供了prompt工程的内容https://open.bigmodel.cn/dev/howuse/prompt</p>
<h4 id="glm-4实战">GLM-4实战</h4>
<ol>
<li>
<p>登录https://open.bigmodel.cn/ 账户注册与API-KEY获取</p>
</li>
<li>
<p>建议新创建一个虚拟环境，安装zhipuai</p>
</li>
</ol>
<pre><code>conda create -n py3.9 python==3.9  
conda activate py3.9  
pip install zhipuai  
</code></pre>
<ol start="3">
<li>demo调用</li>
</ol>
<pre><code>from zhipuai import ZhipuAI  
client = ZhipuAI(api_key=&quot;your api key&quot;)  
response = client.chat.completions.create(  
    model=&quot;glm-4&quot;,  
    messages=[{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;你好,帮我写一个年会开幕词 30字以内&quot;}],  
)  
print(response.choices[0].message)  
</code></pre>
<p>以上调用方式为基于SDK的调用，另外还支持基于HTTP调用</p>
<h4 id="heading"></h4>
<p>SDK是一组工具，库，文档和代码示例，只在帮助开发者更容易更高效低使用特定的API，在基于SDK的API调用中，不需要从新开始编写用于与API通信的代码，可以直接利用SDK中的预写函数和方法</p>
<p>在SDK调用过程中,又可以细分为同步调用、异步调用与SSE调用三种不同的调用方法。</p>
<ul>
<li>
<p>同步调用,指的是我们发起请求,等待朋多器响应后方可进行下一步动作,并且服务器响应也是一次性获得全部结果。</p>
<p>client.chat.completions.create</p>
</li>
<li>
<p>异步调用,则指的是当发起请求后,服务器会先直接响应当前任务ID,此时无论任务是否已经完成,用户都可以直接进行接下来的动作,而当服务器完成任务时,用户可以通过任务ID查看到服务器响应结果;</p>
<p>client.chat.asyncCompletions.create</p>
</li>
<li>
<p>SSE调用,则是指流式传输,此时服务器不再是一次性返回全部内容,而是逐个字符(或者词语)进行返回。</p>
<p># 需要额外参数stream=True<br>
client.chat.completions.create(<br>
  stream=True,<br>
)</p>
<p>#接收情况<br>
for chunk in response_stream:<br>
  print(chunk.choices[0].delta)</p>
</li>
</ul>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFSz9EsSrlIYJNss5e9txT0ofbuXiaaecDJmWwG67ic1Zfd8cW5ITwSGBQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<h4 id="heading-1"></h4>
<h4 id="模型参数介绍">模型参数介绍</h4>
<ol>
<li>chat.completions.create函数参数</li>
</ol>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFFpiaoZc9EvTW1CcExL3yRQmNAs1jXPibD0q93sQ7MUcX7syat15BHDWg/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<ul>
<li>
<p>model，代表的含义是当前调用的模型。目前可选的模型有GLM-3-Turbo、GLM-4;</p>
</li>
<li>
<p>messages，代表传输到模型内部的<strong>消息队列</strong> 。messages参数是一个基本构成元素为字典的列表，其内每个字典都代表一条独立的消息，每个字典都包含两个键值(Key-value)对，其中第一个Key都是字符串role(角色)表示某条消息的作者，第二个key为content (内容)表示消息具体内容。</p>
</li>
<li>
<p>实际使用中发现，对于glm4和glm3模型temperature调整为1和0.1效果差异并不大，但是对于GPT类型模型调整该参数在-2 和 2 之间会有明显差异；</p>
</li>
</ul>
<p>2.chat.completions.create函数响应结果</p>
<pre><code># response content  
Completion(model='glm-4', created=1705575284, choices=[CompletionChoice(index=0, finish_reason='stop', message=CompletionMessage(content='你好👋！我是人工智能助手智谱清言，可以叫我小智🤖，很高兴见到你，欢迎问我任何问题。', role='assistant', tool_calls=None))], request_id='8311643113837941476', id='8311643113837941476', usage=CompletionUsage(prompt_tokens=6, completion_tokens=32, total_tokens=38))  
</code></pre>
<p>因此通过如下可以直接获取返回的信息</p>
<pre><code>response.choices[0].message.content  
</code></pre>
<h4 id="message参数设置方法">Message参数设置方法</h4>
<h4 id="heading-2"></h4>
<p>多角色对话系统：将用户和大模型之间的“私聊”变为“群聊”，在用户<strong>user</strong> 和大模型<strong>assistant</strong> 这两个角色基础之上，进一步增加 “系统”和“工具”这两个角色。最终目的都是为了能完成大模型和用户的之间对话。</p>
<ul>
<li>
<p>例如对话系统中增加的“系统”这一角色，可以为本次对话增加基本背景信息、对大模型进行角色身份设置等，相当于是设置本场对话的基本规则和信息;</p>
</li>
<li>
<p>而对话系统中的“工具”这一角色，则相当于是大模型的拓展工具箱，当大模型无法回答当前问题的时候(例如用户希望查询当前即时天气)，就可以向工具求助，而如果这个“工具”角色能够查到当前天气，则会“告诉”大模型当前天气情况，大模型在接收到了当前天气情况之后再告诉用户。</p>
</li>
</ul>
<h4 id="heading-3"></h4>
<p>messages是一种用于描述ChatCompletion模型和用户之间通信信息的<strong>高级抽象</strong> ，也是支撑多角色对话系统的关键，从表示形式上来说，<strong>一个messages是一个列表，包含多个字典，而每个字典都是一条消息</strong> ，其中，一条消息包含一个键值对(即每个字典都包含两个键值对)，第一个键值对用于表示消息发送者，其中第一个Key为字符串&rsquo;role&rsquo;，Value为参与对话的角色名称，或者可以理解为本条消息的作者或消息发送人名称，第二个键值对表示具体消息内容，Key为字符串&rsquo;content&rsquo;，Value为具体的消息内容，用字符串表示。</p>
<p>上面的例子中，如果一条信息的role是user，则表明这是用户向模型发送的聊天信息，相当于是Completion模型中的<strong>prompt</strong> ，而如果一条信息的role是assistant，则表示这是当前模型围绕某条用户信息做出的回应，相当于是相当于是Completion模型中的text。</p>
<p>注意：</p>
<ul>
<li>
<p>在messages参数中，我们是不能给自己或者模型自定义其他名称的。</p>
</li>
<li>
<p>尽管一个messages可以包含多条信息，但模型只会对于最后一条用户信息进行回答，</p>
</li>
</ul>
<p>比如下面的例子中，只会回答最后一个问题</p>
<pre><code>messages=[  
{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请问什么是机器学习?&quot;},  
{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请问什么是决策树算法?&quot;}  
]  
</code></pre>
<p>那么如何通过message实现多角色对话呢？</p>
<ul>
<li>
<p>最简单的方案是直接将角色背景信息假如user的contant，比如</p>
<p>messages=[<br>
{&ldquo;role&rdquo;: &ldquo;user&rdquo;, &ldquo;content&rdquo;: &ldquo;假设你是一名资深的计算机系大学教授，请帮我回答，什么是机器学习?&rdquo;}<br>
]</p>
</li>
<li>
<p>另一种方案是采用system角色，如下：</p>
</li>
</ul>
<h4 id="system-role-用于身份设定">system role 用于身份设定</h4>
<p>GLM4推荐的方案是使用<strong>system role</strong> ：</p>
<pre><code>client = ZhipuAI(api_key=api_key)   
response = client.chat.completions.create(  
    model=&quot;glm-4&quot;,    
    messages=[  
    {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一名资深的计算机系大学教授&quot;},  
    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请问什么是机器学习？&quot;}  
  ]  
)  
</code></pre>
<p>注意：</p>
<ol>
<li>
<p>通过system_message进行身份设置对于GLM4模型效果较好，而对于GLM3模型来说效果非常不稳定:</p>
</li>
<li>
<p>注意，当messages中只包含一条system消息时，GLM4模型会<strong>直接报错</strong> :</p>
</li>
</ol>
<pre><code>messages=[  
{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一名资深的喜剧演员&quot;}, ]  
</code></pre>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/HIKk7OFDjoTv6mQl5EUOKicPicncVEQdJFYlvMyx7xibwVjTOlWxHx88PGLeIxLSGJ5lyibTyeOCLXO1BjibhTq7ffg/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<ol start="3">
<li>如果需要根据system系统信息对系统进行设置，然后再提问，那么<strong>先system消息再user消息的顺序</strong> 就变得非常重要</li>
</ol>
<p>例如还是上面的例子，我们调换了system消息和user消息的顺序，那么会发现，system消息的作用就会失效，这点和GPT系列模型完全一样:</p>
<pre><code>messages=[  
{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;请问什么是机器学习?&quot;},   
{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;你是一名资深的喜剧演员&quot;}  
]  
</code></pre>
<h4 id="system-messages设置聊天背景信息">system messages设置聊天背景信息</h4>
<p>system消息除了非常便捷的进行提示模板的设计之外，还可以进行聊天背景信息的设定；</p>
<p>在system消息中输入一段长文本，这段长文本将在聊天开始之前输入到系统中，而在之后的聊天中，即可让assistant围绕这个长文本进行回答，这是一种最简单的<strong>实现大语言模型围绕本地知识库进行问答的方法</strong> 。</p>
<p>这里我们在system消息中输入一段关于虚拟人物“陈明”的个人简介，而在之后的提问中，user和assistant将可以自由的围绕这段输入的背景信息进行问答:</p>
<pre><code>text = '陈明，男，1973年7月15日出生于中国福建省厦门市。\ 1991年毕业于厦门大学电子科学与技术系，继而于1998年在北京大学获得信息技术博士学位。\ 毕业后的陈明在硅谷的一家著名科技公司工作了五年，专注于人工智能和机器学习的研发。'  
   
response = client.chat.completions.create( model=&quot;glm-4&quot;,  
messages=[  
{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: text},  
{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: '请问陈明是那一年出生?'}  
] )   
   
</code></pre>
<p>注意：system role输入的信息也是输入给模型的信息，因此受限于大语言模型的最大输入信息长度，单独借助system role在ChatCompletion.create函数中输入背景信息并不能真正意义上实现高度定制化、超大规模文本的本地知识库问答。但是，如果围绕着超大规模本地文本知识库先进行基于滑动窗口的文本切分，以确保切分后的小文本段落满足Max tokens要求，并且配合Embedding过程进行user问题和短文本的实时匹配，再把每个user问题匹配的关联度最高的文本以system消息的形式输入到模型中，再进行回答，则可以非常高效并且准确的实现本地知识库问答。而在这个过程中，借助system role进行背景文字的输入就非常基本的技术手段。</p>
<h4 id="message-实现多轮对话">message 实现多轮对话</h4>
<p>messages参数的另一个重要应用是<strong>借助append方法来高效实现多轮对话</strong> 。不同于Completion模型需要将历史问答都拼接为一个字符串并输入到新的prompt中来实现历史消息的输入，对于Chat模型来说，我们只需要将模型返回的message消息+用户新的提问message拼接到模型的messages参数中，并再次向模型进行提问，即可非常便捷的实现多轮对话。</p>
<pre><code>messages.append({&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: response.choices[0].message.content})  
  
messages.append({'role': 'user', 'content': '请问我刚才的问题是?'})  
  
接下来再次调用模型，并输入messages作为参数，此时模型将同时结合此前的所有消息，并围绕最后一个user信息进行回答:  
response = client.chat.completions.create(   
  model=&quot;glm-4&quot;,  
  messages=messages   
)  
</code></pre>
<p><strong>进技术交流群请添加AINLP小助手微信（id: ainlp2)</strong></p>
<p><strong>请备注具体方向+所用到的相关技术点</strong></p>
<pre><code>![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJADkmZ2IX6Z23znAibuEevotDMq9iaMxiapK7jfMibiauGFkycicAJEs6x5U9SGyDJZ0S1tRed9TPNUUDQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)
</code></pre>
<p><strong>关于AINLP</strong></p>
<pre><code>AINLP 是一个有趣有AI的自然语言处理社区，专注于 AI、NLP、机器学习、深度学习、推荐算法等相关技术的分享，主题包括LLM、预训练模型、自动生成、文本摘要、智能问答、聊天机器人、机器翻译、知识图谱、推荐系统、计算广告、招聘信息、求职经验分享等，欢迎关注！加技术交流群请添加AINLP小助手微信(id：ainlp2)，备注工作/研究方向+加群目的。

  


![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSKABHCqVVQkVYPrM4XY1vsd0iaeuXzyJnoFc8cibd5mYb4wdA3WMQtiaPVmr0XLZHMuVibqWncibpnTSnQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)       
</code></pre>
<p>更多AI工具，参考<a href="https://ai123.869hr.uk/">Github-AI123</a>，<a href="https://ai123.869hr.uk/">国内AI123</a></p>



          </div>

 可扫如下微信二维码加好友

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


