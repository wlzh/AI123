

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>Firefly单卡复刻Vicuna-13B，OpenLLM榜单🤗略高02分 作者： YeungNLP 来源： YeungNLP 01 前言 在过去的几个月里，经过不断的迭代更新，Firefly项目已支持对LLaMA-2、Ziya、Baichuan、InternLM、LLaMA-1、Bloom等模型进行指令微调，并且开源了多个经过中文指令微调的模型权重，获得  | AI123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AI123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://ai123.869hr.uk/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://ai123.869hr.uk/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AI123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AI123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AI123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AI123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">Firefly单卡复刻Vicuna-13B，OpenLLM榜单🤗略高02分</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://ai123.869hr.uk/about>AI123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              July 21, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicHFgXPUaMfHsRsFxkbY7RstWHqevibescAY9KjnD1Td0RNOnzR9Quadw/640?wx_fmt=png" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： YeungNLP  来源： <a href="https://mp.weixin.qq.com/s/QG2YMo_QxaxS_Rr2yJrIeA">YeungNLP</a></p>
<p><strong>01</strong></p>
<p>前言</p>
<p>在过去的几个月里，经过不断的迭代更新，Firefly项目已支持对LLaMA-2、Ziya、Baichuan、InternLM、LLaMA-1、Bloom等模型进行指令微调，并且开源了多个经过中文指令微调的模型权重，获得了很多同学的支持。目前本项目在Github上获得了1100+star⭐️，感谢大家的关注和支持。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NHB58XHhmxD2AkpqYZickMjJchic0xDDVVNE07he5UXu3vZF9zOGQ1BDEILYe62zSWMeeJnQM8xMHOw/640?wx_fmt=jpeg" alt=""></p>
<p>此前，我们花了较多精力在优化训练流程之上，而随着项目的不断迭代，我们越发感受到模型评测的重要性。此前我们更多是以看case的形式，主观判断模型的效果，不严谨其说服力不足，无法衡量Firefly的能力。</p>
<p>我们也在逐步完善项目的模型评测工作。此次，我们开源了<strong>firefly-llama-13b</strong> ，并且在🤗Hugging Face的Open LLM榜单上进行了客观的评测。</p>
<p>在榜单上，firefly-llama-13b取得了不错的效果，<strong>比vicuna-13b-1.1略高0.2分</strong> ，<strong>比llams-2-13b-chat略低0.5分</strong> ，<strong>比vicuna-13b-v1.3略低0.6分</strong> 。从评测分数来看，firefly-llama-13b与vicuna-13b、llama-2-13b-chat的水平非常接近😎。</p>
<p>注：表中各列依次为Average、ARC、HellaSwag、MMLU、TruthfulQA (MC)。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NHB58XHhmxD2AkpqYZickMjJOlLU1glxuNDjS9Hxa8z5XaSSQMktgyyhibib23rz3D8hoDOZ1JhZFQeQ/640?wx_fmt=jpeg" alt=""></p>
<p>Firefly项目地址：</p>
<p><a href="https://github.com/yangjianxin1/Firefly">https://github.com/yangjianxin1/Firefly</a></p>
<p>firefly-llama-13b权重：</p>
<p><a href="https://huggingface.co/YeungNLP/firefly-llama-13b">https://huggingface.co/YeungNLP/firefly-llama-13b</a></p>
<p>🤗 Open LLM排行榜：</p>
<p><a href="https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard">https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard</a></p>
<p><strong>02</strong></p>
<p>模型指标</p>
<p>🤗 Open LLM排行榜是Hugging Face设立的一个用于评测开放大语言模型的公开榜单。该榜单一共包括以下四个评测基准：</p>
<ul>
<li>
<p><strong>AI2 Reasoning Challenge</strong> ：一套小学科学问题。</p>
</li>
<li>
<p><strong>HellaSwag</strong> ：一个测试常识推理的测试，对人类来说很容易（~95%），但对语言模型来说却具有挑战性。</p>
</li>
<li>
<p><strong>MMLU</strong> ：一个测试文本模型的多任务准确性的测试。测试覆盖57个任务，包括基础数学、美国历史、计算机科学、法律等。</p>
</li>
<li>
<p><strong>Truthful QA MC</strong> ：一个测试语言模型在生成问题答案时是否真实的基准。</p>
</li>
</ul>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/5LJDib8HPR2qibDmEuthzJMmuHQrc7Gnx79OTfRD0SvicjxXjtTY5d10lAK2VSg4AEgK1Sk2d5o5lnUxKMWARwTLA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p>
<p>firefly-llama-13b在Open LLM榜单上的评测结果如下：</p>
<ol>
<li>
<p><strong>firefly-llama-13b以59.4分的成绩，超越vicuna-13b-1.1的59.2分和guanaco-13b的59.1分</strong> 。</p>
</li>
<li>
<p>仅比最近大火的Llama-2-13b-chat-hf的59.9分，略低0.5分；比vicuna-13b-v1.3的60分，略低0.6分。</p>
</li>
<li>
<p>大幅领先vicuna-7b-v1.3和mpt-7b-chat等7B参数量的模型。</p>
</li>
<li>
<p>firefly-llama-13b在ARC评测集上比vicuna-13b-v1.3高4.4分，在TruthfulQA评测集上比Llama-2-13b-chat-hf高5.5分。美中不足的是，firefly-llama-13b在MMLU和TruthfulQA评测集上的表现和vicuna-13b还有一定的差距。</p>
</li>
</ol>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NHB58XHhmxD2AkpqYZickMjJic2HUSbianVJSickvGcZIhQVmgo15jABV5BJLU9JkVENxAnkhbFkPwp4w/640?wx_fmt=jpeg" alt=""></p>
<p>该评测结果验证了Firefly的QLoRA训练流程的有效性。对于TruthfulQA与MMLU评测效果的不足之处，我们也正在进行一项数据实验。</p>
<p>值得注意的是，<strong>vicuna-13b模型采用的是全量参数微调</strong> ，对训练资源的要求十分高。而<strong>firefly-llama-13b采用的则是QLoRA微调</strong> ，最少仅需16G显存，即可对13B的模型进行微调。</p>
<p>我们使用Firefly的QLoRA训练pipeline对llama-13b进行指令微调，当长度为1024，batch size为1时，<strong>显存占用不到16G</strong> ，一张24G的显卡便可满足训练条件，极大地降低了百亿大模型的训练门槛。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NGP75pT4un6x5wmkT6qZIdicVXOog1veNEJKo3dIwUnXCEicfBxJdrstvyudDjRzX5mR59wibELnqa2w/640?wx_fmt=jpeg" alt=""></p>
<p><strong>02</strong></p>
<p>训练策略</p>
<p>我们采用QLoRA策略来训练firefly-llama-13b。对于QLoRA的原理和训练流程尚不熟悉的同学，可参考我们往期的文章介绍：</p>
<ol>
<li>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA3MTgwODE1Ng==&amp;mid=2247484343&amp;idx=1&amp;sn=a77a9ebc827a88b55a5736d5ac648d1e&amp;chksm=9f26a644a8512f52c44e4fad48ae57f5147023d8c76c35cc2306af44e4d7155e213bdfde4cbc&amp;scene=21#wechat_redirect">微调百川Baichuan-13B保姆式教程，手把手教你训练百亿大模型</a></p>
</li>
<li>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA3MTgwODE1Ng==&amp;mid=2247484306&amp;idx=1&amp;sn=93c7917f2fc07d9a8fec16e8105777be&amp;chksm=9f26a661a8512f779fce072736e70625b028b0c644c7013e2291b2cb3fa304e717289d8f374f&amp;scene=21#wechat_redirect">Firefly-13B开源，QLoRA+百万数据，单卡可训百亿大模型</a></p>
</li>
<li>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA3MTgwODE1Ng==&amp;mid=2247484237&amp;idx=1&amp;sn=74650dc9ccef16e887a358a3e7d2bf88&amp;chksm=9f26a6bea8512fa830573cf7af37fb7f436c7df00d8840dd8887d61a4f352c91c98dd27c7060&amp;scene=21#wechat_redirect">Firefly｜百川baichuan-7B实测，QLoRA+百万指令数据微调</a></p>
</li>
<li>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA3MTgwODE1Ng==&amp;mid=2247484205&amp;idx=1&amp;sn=6d42a755d6195b023e357052fcd87475&amp;chksm=9f26a6dea8512fc8c21020ec1bff2cbe32c82816b36fba062f5eb813f0a8f6e5cca226c80d00&amp;scene=21#wechat_redirect">Firefly | QLoRA+百万数据，多卡高效微调bloom-7b1模型</a></p>
</li>
<li>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA3MTgwODE1Ng==&amp;mid=2247484183&amp;idx=1&amp;sn=5ed7b3e2eb6a7af36c5900d589d7395a&amp;chksm=9f26a6e4a8512ff26a406ed7cf796b02337ab3f14eda0a5c8eff8b3c5bbb8a239b0272e9a97b&amp;scene=21#wechat_redirect">【QLoRA实战】使用单卡高效微调bloom-7b1，效果惊艳</a></p>
</li>
</ol>
<p>我们采用huggyllama/llama-13b作为基座模型，使用UltraChat数据集，这是由清华大学开源的英文多轮对话数据，包含140万条多轮对话数据。我们仅训练一个epoch。</p>
<p>我们将训练数据整理成jsonl格式，每条数据格式如下，其中conversation字段是必需的。</p>
<hr>
<pre><code>{
    &quot;conversation_id&quot;:&quot;4&quot;,
    &quot;dataset&quot;:&quot;UltraChat&quot;,
    &quot;conversation&quot;:[
        {
            &quot;human&quot;:&quot;What is the most popular smartphone brand these days?&quot;,
            &quot;assistant&quot;:&quot;As an AI language model, I don't have updated information on the current market scenario. However, according to recent statistics, Samsung, Apple, and Huawei are among the most popular smartphone brands worldwide.&quot;
        },
        {
            &quot;human&quot;:&quot;Interesting! Among these three brands, which one do you think has the most features and benefits for its price?&quot;,
            &quot;assistant&quot;:&quot;As an AI language model, I cannot have personal opinions or bias towards any brand. However, all three brands - Samsung, Apple, and Huawei - offer different features and benefits at different price points. It ultimately comes down to your personal preferences and requirements, like camera quality, design, software, operating system, and other factors, to choose the right brand and model that fits your needs and budget.&quot;
        },
        {
            &quot;human&quot;:&quot;Can you tell me more about the camera quality of these three brands? Which one has the best camera performance?&quot;,
            &quot;assistant&quot;:&quot;Sure, I can provide you with some information about the camera quality of these three smartphone brands.\n\n1. Apple: iPhones are well known for their camera performance. The latest iPhone models come with a dual-camera or triple-camera setup that is capable of capturing stunning pictures and videos. Apple also introduced features like Night mode, Deep Fusion, and LiDAR Scanner that enhance the camera quality even further.\n\n2. Samsung: Samsung's flagship smartphone models like Galaxy S and Galaxy Note series are known for their camera capabilities. The latest models of Samsung smartphones come with a high-resolution camera that produces excellent pictures with vibrant colors and sharp details. Samsung also offers features like a 108-megapixel camera, Space Zoom, and Single Take mode that enhance the camera quality.\n\n3. Huawei: Huawei smartphones are known for their camera performance and innovation. The latest models like P40 Pro and P40 Pro+ come with a high-resolution camera, and Huawei's proprietary camera technology produces excellent picture quality. Huawei phones also offer features like SuperZoom, AI Cinema, and other editing tools to enhance the camera experience.\n\nAll three brands offer excellent camera quality, but the best camera among these three brands would depend on individual preferences and usage. It's recommended to compare the camera specifications, sample pictures, and features of each brand's models to choose the one that fits your requirements.&quot;
        },
        {
            &quot;human&quot;:&quot;That's helpful. I'm particularly interested in low-light photography. Which of these three brands would you suggest for taking good quality pictures in low light?&quot;,
            &quot;assistant&quot;:&quot;All three brands - Apple, Samsung, and Huawei - offer excellent low-light photography options, but their approach to low-light photography is different, and each brand has its own strengths and weaknesses when it comes to capturing photos in low light. Here's a brief overview of each brand's approach to low-light photography.\n\n1. Apple: Apple's Night mode feature, which is available on recent iPhone models, is designed to take bright and detailed photos in low light. Night mode uses a combination of multi-frame image processing and advanced machine learning to capture crisp and clear images in both indoor and outdoor low-light environments.\n\n2. Samsung: Samsung's low-light photography capabilities are mainly powered by its camera's sensor and lens technology. The newer Samsung Galaxy S and Galaxy Note models come with a larger sensor and wider aperture, which allows more light to enter the device, resulting in brighter and more detailed photos. These models also use Multi-Frame Noise Reduction and Scene Optimizer to improve the quality of photos taken in low light.\n\n3. Huawei: Huawei is known for its exceptional low-light photography capabilities. Huawei's proprietary camera technology, which uses a combination of large sensors, advanced algorithms, and AI, produces bright and detailed low-light photos. The Huawei P40 Pro and P40 Pro+ models come with a SuperSensing 50-megapixel main lens, which enables capturing clear images in low-light conditions.\n\nAll three brands offer great options, but if you are looking for capturing low light photos primarily, then Huawei's P40 Pro, P40 Pro+ or Mate 40 Pro might be a good choice for you due to the brand's focus on low-light photography features.&quot;
        },
        {
            &quot;human&quot;:&quot;I'm also curious about the battery life of these smartphones. Which brand offers the longest battery life on average?&quot;,
            &quot;assistant&quot;:&quot;Battery life is an important factor for anyone looking to buy a smartphone, and all three brands - Apple, Samsung, and Huawei - offer different battery life options. 1. Apple: Battery life on iPhones can last anywhere from 4 to 10 hours, depending on the model you choose. Apple's latest iPhone models come with improved battery life with all-day battery performance. However, if you tend to use your smartphone frequently or for more power-intensive tasks, such as gaming or video playback, you may need to charge your iPhone more frequently. 2. Samsung: Samsung's Galaxy series has excellent battery life, and the newer models like the Galaxy S21 and Galaxy Note 20 are designed to last all day long. The battery life on Samsung phones varies from one model to another, but in general, they offer better battery life compared to iPhones. 3. Huawei: Huawei phones are often praised for their long battery life. They come with large-capacity batteries that can last up to two days, depending on usage. The latest Huawei models like the P40 Pro and Mate 40 Pro, also have fast charging features, which means you can quickly refuel your smartphone's battery when it's running low. In conclusion, all three brands offer decent battery life, but Huawei typically offers the longest battery life on average, followed by Samsung.&quot;
        },
        {
            &quot;human&quot;:&quot;That's good to know. I'm also wondering about the durability of these smartphones. Which brand offers the most durable phones? I tend to drop my phone frequently, so I want something that can handle a few falls.&quot;,
            &quot;assistant&quot;:&quot;All three Smartphone brands - Apple, Samsung, and Huawei - offer durable smartphones, but it's hard to say which one is the most durable since different models have different levels of durability. That being said, here is some information on their durability.\n\n1. Apple: Apple is known for offering durable and sturdy smartphones that can withstand some rough handling. Recent iPhone models come with reinforced glass and are water and dust-resistant. However, with its sleek designs, the iPhone models may be more prone to shattering and cracking if dropped.\n\n2. Samsung: Samsung smartphones like the Galaxy S and Galaxy Note series are generally sturdy and are made with scratch-resistant glass. The newer models are water and dust resistant and come with reinforced corners to protect against drops and bumps.\n\n3. Huawei: Huawei also offers durable smartphones that can handle some falls and rough handling. The latest Huawei models usually come with a sturdy build, reinforced corners, and scratch-resistant glass. The Huawei Mate 40 Pro even has a ceramic back, making it extra durable.\n\nIn conclusion, all three brands - Apple, Samsung, and Huawei - offer durable smartphones that can handle some drops, but the level of durability varies from model to model. If frequent drops are a concern, it's recommended to choose a phone with a rugged case or invest in a protective case to ensure better protection.&quot;
        }
  

    ]
}
</code></pre>
<p>训练时，我们将多轮对话拼接成如下格式，然后进行tokenize。</p>
<ul>
<li></li>
</ul>
<pre><code>&lt;s&gt;input1&lt;/s&gt;target1&lt;/s&gt;input2&lt;/s&gt;target2&lt;/s&gt;...
</code></pre>
<p>在计算loss时，我们通过mask的方式，input部分的loss不参与参数更新，只有“target</s>”部分的loss参与参数更新。这种方式充分利用了模型并行计算的优势，训练更加高效，且多轮对话中的每个target部分都参与了训练，训练更充分。否则，就需要把一个n轮对话，拆分成n条数据，且只计算最后一个target的loss，大大降低了训练效率。</p>
<p>loss计算的实现方式可参考以下代码：</p>
<p><a href="https://github.com/yangjianxin1/Firefly/blob/master/component/loss.py#L3">https://github.com/yangjianxin1/Firefly/blob/master/component/loss.py#L3</a></p>
<p>对于QLoRA，除了embedding和lm_head外，我们在所有全连接层都插入adapter，其中lora_rank为64，lora_alpha为16，lora_dropout为0.05。最终<strong>参与训练的参数量约为2.5亿</strong> 。</p>
<p>训练超参数如下所示：</p>
<p>max length
1024</p>
<p>lr_scheduler_type
constant_with_warmup</p>
<p>batch size
64</p>
<p>lr
1e-4</p>
<p>warmup step
3000</p>
<p>optimizer
paged_adamw_32bit</p>
<p>training step
23k</p>
<p>模型的训练损失的变化趋势如下图所示。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicicbm4AuiavD2OTicg1S36IfbkmxbntMLRTGAryyvw8Sq864zNjqQOPpVQ/640?wx_fmt=png" alt=""></p>
<p><strong>03</strong></p>
<p>效果对比</p>
<p>我们使用Vicuna官网中的部分输入进行测试，以对比vicuna-13b与firefly-llama-13b的生成结果。</p>
<p>注：vicuna-13b的结果为其官网展示样例。</p>
<p>示例1：【撰写一篇引人入胜的旅行博客文章，内容涉及最近去夏威夷旅行，强调文化经历和必看的景点。】</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicaFQSHudfMHmX44mLGZBhdNyby5bPiakLGMnDJcWYdnCF2kDyLqxtFLw/640?wx_fmt=png" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdic8AC68twGI7FymdqwEZEe7sXSAPticLVrPw6JtHODhj9h21icyno3hIpg/640?wx_fmt=png" alt=""></p>
<p>示例2：【如果14世纪没有发生黑死病会怎样？】</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicHFgXPUaMfHsRsFxkbY7RstWHqevibescAY9KjnD1Td0RNOnzR9Quadw/640?wx_fmt=png" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdick7vtBE7dbYTJwdUu3v0jKgiaQtPFg3Mgmr5TdibEPJ7rKtu4ayTk70hA/640?wx_fmt=png" alt=""></p>
<p>示例3：【如果艾萨克·牛顿专注于生物学而不是物理学会怎样？】</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdic1xOoiaSdsW1Nw4ibMR2d3ZIkdYY3gRHcGiatwlLSejLN8RLgkDuHCHrjA/640?wx_fmt=png" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicsZbibETWaxWiaRcJkb5s769VYelzVZL8qTjlf444IbDBHSBicaTia1E8Pw/640?wx_fmt=png" alt=""></p>
<p>示例4：【使用一次性塑料瓶而不是可重复使用的瓶子，对环境和人类健康有什么潜在影响？】</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdicEwga4RWoiafC0TM67DEMbps5sa9r80gQTScDCyxm2AjOa8wxuSm2Lkw/640?wx_fmt=png" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/JrHT8u594NGP75pT4un6x5wmkT6qZIdiciarT0FocxualpicPbiaOATicby9C15hbd7zBTQrJjsOJ26RVXKMqZib4q4A/640?wx_fmt=png" alt=""></p>
<p>我们将在共享文档中补充更多的对比结果：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NFvUcf1331MqHYhd35c89NicQk2icat6ozA7CXSBKI2vpf6sTxEHLvYomSCvpiayXCbwBKtXLFcdXjNw/640?wx_fmt=jpeg" alt=""></p>
<p>从一些生成例子来看，firefly-llama-13b与vicuna-13b的性能比较接近。</p>
<p><strong>04</strong></p>
<p>结语</p>
<p>此次我们开源了firefly-llama-13b，在Open LLM排行榜上的评测结果与vicuna-13b、Llama-2-13b-chat非常接近，验证了Firefly的QLoRA训练流程的有效性。</p>
<p>QLoRA工作一经发布，Firefly项目便开始研究和探索QLoRA训练方案。随着不断迭代更新，项目支持对越来越多的模型进行微调，也开源了一些中文模型，但始终缺乏评测环节。此次的评测工作，弥补了项目在这方面的缺失，验证了训练流程的有效性。</p>
<p>借着LLaMA-2🦙的契机，我们也正在筹划一个中文版的LLaMA-2开源项目Firefly-LLaMA-Chinese。该项目也将同时兼容对Baichuan、InternLM等中文大模型的增量预训练</p>
<p>授人以鱼🐟，不如授人以渔🎣，与Firefly项目一脉相承，本项目也将为广大开发者提供低成本的增量预训练方案。</p>
<p>🔥欢迎关注我们的新项目，欢迎大家的宝贵建议和意见：</p>
<p><a href="https://github.com/yangjianxin1/Firefly-LLaMA2-Chinese">https://github.com/yangjianxin1/Firefly-LLaMA2-Chinese</a></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NHB58XHhmxD2AkpqYZickMjJuvXibZpaOwTStX6WtnDrgibmSPLgica1uFQXD8B1m0y9vcHQDhDhbPx0Q/640?wx_fmt=jpeg" alt=""></p>
<p>欢迎加入Firefly大模型技术交流群。如二维码失效，可以在公众号后台回复【加群】。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/JrHT8u594NHB58XHhmxD2AkpqYZickMjJEZ9xGgxIGdUKyGpE4FlxfWyJibam3Rp0YLvf4oqRmOyiaKDOoywaLgEw/640?wx_fmt=jpeg" alt=""></p>
<p>您的<strong>点赞、在看、关注</strong> 是我坚持的最大动力！</p>
<p>更多AI工具，参考<a href="https://ai123.869hr.uk/">Github-AI123</a>，<a href="https://ai123.869hr.uk/">国内AI123</a></p>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


